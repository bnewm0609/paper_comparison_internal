{"id": 204819040, "updated": "2023-06-27 21:46:09.411", "metadata": {"title": "Characterizing Attacker Behavior in a Cybersecurity Penetration Testing Competition", "authors": "[{\"first\":\"Nuthan\",\"last\":\"Munaiah\",\"middle\":[]},{\"first\":\"Akond\",\"last\":\"Rahman\",\"middle\":[]},{\"first\":\"Justin\",\"last\":\"Pelletier\",\"middle\":[]},{\"first\":\"Laurie\",\"last\":\"Williams\",\"middle\":[]},{\"first\":\"Andrew\",\"last\":\"Meneely\",\"middle\":[]}]", "venue": "2019 ACM/IEEE International Symposium on Empirical Software Engineering and Measurement (ESEM)", "journal": "2019 ACM/IEEE International Symposium on Empirical Software Engineering and Measurement (ESEM)", "publication_date": {"year": 2019, "month": null, "day": null}, "abstract": "Background: Inculcating an attacker mindset (i.e. learning to think like an attacker) is an essential skill for engineers and administrators to improve the overall security of software. Describing the approach that adversaries use to discover and exploit vulnerabilities to infiltrate software systems can help inform such an attacker mindset. Aims: Our goal is to assist developers and administrators in inculcating an attacker mindset by proposing an approach to codify attacker behavior in cybersecurity penetration testing competition. Method: We use an existing multimodal dataset of events captured during the 2018 National Collegiate Penetration Testing Competition (CPTC\u201918) to characterize the approach a team of attackers used to discover and exploit vulnerabilities. Results: We collected 44 events to characterize the approach that one of the participating teams took to discover and exploit seven vulnerabilities. We used the MITRE ATT&CK\u2122 framework to codify the approach in terms of tactics and techniques. Conclusions: We show that characterizing attackers\u2019 campaign as a chronological sequence of MITRE ATT&CK\u2122 tactics and techniques is feasible. We hope that such a characterization can inform the attacker mindset of engineers and administrators in their pursuit of engineering secure software systems.", "fields_of_study": "[\"Computer Science\"]", "external_ids": {"arxiv": null, "mag": "2980790296", "acl": null, "pubmed": null, "pubmedcentral": null, "dblp": "conf/esem/MunaiahRPWM19", "doi": "10.1109/esem.2019.8870147"}}, "content": {"source": {"pdf_hash": "b461f6823612465abd8c3bdffa112f20b682c6e4", "pdf_src": "MergedPDFExtraction", "pdf_uri": null, "oa_url_match": false, "oa_info": null}, "grobid": {"id": "c5c718172e81b09048d8d5e73d9104388e873d63", "type": "plain-text", "url": "s3://ai2-s2-pdf-extraction-prod/parse-results/s2orc_worker/b461f6823612465abd8c3bdffa112f20b682c6e4.txt", "contents": "\nCharacterizing Attacker Behavior in a Cybersecurity Penetration Testing Competition\n\n\nNuthan Munaiah \nAkond Rahman aarahman@ncsu.edu \nNorth Carolina State University\n27695RaleighNC\n\nJustin Pelletier \nLaurie Williams williams@csc.ncsu.edu \nNorth Carolina State University\n27695RaleighNC\n\nAndrew Meneely \n\nRochester Institute of Technology\n14623RochesterNY\n\nCharacterizing Attacker Behavior in a Cybersecurity Penetration Testing Competition\nIndex Terms-securityvulnerabilityattack\nBackground: Inculcating an attacker mindset (i.e. learning to think like an attacker) is an essential skill for engineers and administrators to improve the overall security of software. Describing the approach that adversaries use to discover and exploit vulnerabilities to infiltrate software systems can help inform such an attacker mindset. Aims: Our goal is to assist developers and administrators in inculcating an attacker mindset by proposing an approach to codify attacker behavior in cybersecurity penetration testing competition. Method: We use an existing multimodal dataset of events captured during the 2018 National Collegiate Penetration Testing Competition (CPTC'18) to characterize the approach a team of attackers used to discover and exploit vulnerabilities. Results: We collected 44 events to characterize the approach that one of the participating teams took to discover and exploit seven vulnerabilities. We used the MITRE ATT&CK\u2122 framework to codify the approach in terms of tactics and techniques. Conclusions: We show that characterizing attackers' campaign as a chronological sequence of MITRE ATT&CK\u2122 tactics and techniques is feasible. We hope that such a characterization can inform the attacker mindset of engineers and administrators in their pursuit of engineering secure software systems.\n\nI. INTRODUCTION\n\nThe importance of security in the engineering and administration of software systems is unquestionable. The last decade has been witness to numerous security vulnerabilities in software exploited to catastrophic effects. While some of these vulnerabilities (like Heartbleed in OpenSSL, Shellshock in Bash, and a vulnerability in Apache Struts that led to the recent Equifax data breach) have garnered widespread infamy, there are several others that developers regularly discover and address. Despite best efforts, the potential for yet undiscovered vulnerabilities in software presents a grim reality [1].\n\nAdversaries, be they ethical white hat hackers or malicious black hat hackers, are behind every vulnerability exploit. The ability to understand the way in which these adversaries discover and exploit vulnerabilities to infiltrate systems can help bring the attacker mindset out of the wild and into the software development process.\n\nThe foundational element in inculcating the attacker mindset is to think like an attacker when implementing code or configuration changes to software systems. As the complexity of the software system increases, speculating the different ways in which an attacker could exploit a vulnerability becomes a daunting task. The key, therefore, is to leverage empirical information to characterize the typical ways in which attackers tend to discover and exploit vulnerabilities. The limitation, however, is the scarcity of such empirical information.\n\nIn the past, researchers [2], [3] have attempted to infer attackers' modus operandi from packet capture or intrusion alert datasets. These datasets, being at the network level, do not render themselves useful for analyses using a postcompromise attacker-behavior-based investigation model such as the MITRE ATT&CK\u2122 [4]. However, a recently released multimodal dataset [5] of events captured during a cybersecurity penetration testing competition provides an opportunity to empirically characterize the approach that participating teams used to discover and exploit vulnerabilities in a controlled environment.\n\nOur goal is to assist developers and administrators in inculcating an attacker mindset by proposing an approach to codify attacker behavior in cybersecurity penetration testing competition. We address the following research question to accomplish this goal: RQ What MITRE ATT&CK\u2122 tactics and techniques can be inferred from the competition data set? We analyzed a multimodal dataset containing over 500 million events from six teams of attackers captured and curated by Munaiah et al. [5] during the 2018 National Collegiate Penetration Testing Competition (CPTC'18). The primary contribution of our work is an approach to describe attacker behavior using empirical data that captures the vulnerability discovery and exploit from both the victims' and attackers' perspectives.\n\n\nII. DATASET\n\nThe dataset used in addressing the research question was collected and curated by Munaiah et al. [5] during the 2018 National Collegiate Penetration Testing Competition (CPTC'18). An interesting aspect of the dataset is that it contains an account of the entire competition from both the victim's and the attacker's perspective. The paper [5] accompanying the dataset has more information about the competition, in general, and the dataset, in particular. However, we provide a brief overview of details that are relevant to this study in the remainder of this section. 978-1-7281-2968-6/19/$31.00 \u00a92019 IEEE CPTC'18 had nine teams competing to discover and exploit vulnerabilities in an enterprise cyberinfrastructure advertised as belonging to a fictitious ride sharing organization (WHEELZ). Each team was provided an isolated and identical copy of the competition infrastructure. The infrastructure was composed of four subnetworks (vdi, corp, prod, and auto) with some level of interconnection between them. The vdi subnetwork contained hosts that the attackers had full access to to carry out their attack campaign. The range of addresses in corp, prod, and auto was the only other piece of information about the infrastructure provided to the participants.\n\nThe dataset is a collection of events captured and indexed by Splunk, a log aggregation platform, from all hosts in the competition infrastructure. Each host in the competition infrastructure was instrumented with a Splunk agent which periodically captured information from a plethora of sources on the host. In addition to the raw data, all events in the dataset are associated with essential metadata, such as the timestamp at which the event was indexed; the name of the host where the event originated; and source type identifying the source of the event on the host.\n\nThe event source type is critical to the analysis of the dataset because it indicates the kind of data an event contains, and can be used as a proxy for granularity of the event data. For instance, an event with mongodb as the source type contains information about log generated by MongoDB instance on a host, whereas, an event with stream:tcp as the source type contains information about TCP packets sent to/from the host. When analyzing the dataset, a mongodb event, being at the application level, is at a higher level of granularity than stream:tcp event, which is at a network level.\n\n\nIII. VULNERABILITIES\n\nThe dataset contains over 500 million events associated with over 113 source types. The metadata associated with the events (source type, in particular) affords us the ability to filter events with relative ease. However, any approach to analyze the events with no hint of attributes of relevance would be akin to searching for a needle in a haystack. The key, therefore, is to leverage the knowledge of the known vulnerabilities in the competition infrastructure that were attributed to have been discovered and/or exploited by an attacker (or, more accurately, a team of attackers).\n\nThe competition infrastructure was engineered to have 74 known vulnerabilities with varying levels of severity and difficulty. In aggregate, 29 of the 74 vulnerabilities were discovered and/or exploited by participating teams.\n\nIn this preliminary work, we use vulnerabilities attributed to Team 1 to present our approach to characterize attacker behavior. Team 1 was attributed to have discovered and/or exploited the following seven vulnerabilities: (1) Unauthenticated remote administrator access to MongoDB, (2) blank domain administrator password, (3) no SSL on sensitive web application, (4) cleartext credentials in chat history, (5) API documentation leaked on HeckForums, (6) backup file on workstation, and (7) unauthenticated access to sensitive API.\n\nEach of the aforementioned vulnerabilities were isolated to a specific host. For instance, the unauthenticated access to sensitive API vulnerability was in an application that was deployed on onramp-00 host in the corp network. The prior knowledge of vulnerabilities that a team discovered and/or exploited alleviates the seemingly intractable task of gathering evidence from the dataset to construct a timeline of events that characterize the attackers' modus operandi.\n\nWe use the unauthenticated remote administrator access to MongoDB as an example at specific points (like in describing the methodology in Section V) in the remainder of this paper. We refer to this vulnerability as MongoDB vulnerability for brevity. The MongoDB vulnerability was caused by incorrect configuration of the MongoDB server instance on the corp\\talk-00 which permitted remote access with no password. An attacker could exploit the vulnerability by running mongo --port 27017 10.0.0.20, where, 10.0.0.20 is the IP address of corp\\talk-00.\n\nIn the remainder of this paper, we use the term attack to refer to the act of an attacker discovering and/or exploiting a vulnerability.\n\nIV. LIFECYCLE OF AN ATTACK While a timeline of events that characterizes the modus operandi of an attacker is interesting, inferring the tactics and techniques that the attacker may have used in their campaign is essential to developing a generalizable understanding of the behavior of a typical attacker. One way to achieve such a generalizable understanding is to describe the timeline of events using a framework that is meant to characterize the lifecycle of an attack. Mandiant's Attack Lifecycle Model [6], Lockheed Martin's Cyber Kill Chain\u00ae [7], and the MITRE Adversarial Tactics Techniques and Common Knowledge (ATT&CK\u2122) framework [4] are the most commonly used approaches to characterize the lifecycle of an attack.\n\nIn our work, we use ATT&CK to translate the timeline of events in attackers' modus operandi to tactics and techniques. We chose ATT&CK because of its emphasis on postcompromise modeling of the threat in an environment based on behavioral aspects of the attacker [4].\n\n\nA. MITRE ATT&CK\u2122 Framework\n\nThe MITRE ATT&CK\u2122 framework is a knowledge base of tactics and techniques that may be used to model the behavior of an attacker [8]. The framework is updated every quarter and its contents are curated by MITRE with contributions from the broader cybersecurity community.\n\nAs the name indicates, the framework is a collection of tactics and techniques that an attacker can use to discover and/or exploit a vulnerability. The tactics and techniques are informed by intelligence from incident reporting on real cyber attacks that are publicly available. As of this writing, ATT&CK is organized into two technology domains: Enterprise, representing a traditional enterprise network, and Mobile, representing mobile communication devices. In our work, we restrict ourselves to the Enterprise technology domain since the competition infrastructure resembles that of a traditional enterprise network. At the time we used the framework in our work, ATT&CK had 11 tactics and 223 techniques.\n\nIn the context of an attack, ATT&CK technique answers the question \"How did the attacker discover and/or exploit a vulnerability?\" and the corresponding ATT&CK tactic answers the question \"Why did the attacker discover and/or exploit a vulnerability?\" In other words, an ATT&CK technique is the approach an attacker used whereas the corresponding ATT&CK tactic is the objective behind the attack. For instance, an attacker can use a port scanning utility like nmap (the approach) to identify all the open ports on a machine (the objective). In terms of ATT&CK, we can describe this attack as the attacker using the network service scanning technique and the discovery tactic.\n\n\nV. METHODOLOGY\n\nIn this section, we describe our methodology to (1) gather evidence of an attack and (2) characterize attacker behavior by identifying ATT&CK tactic(s) and technique(s) that capture the objective and approach of the attacker in the attack, respectively.\n\n\nA. Evidence Gathering\n\nIn this phase, we gather evidence to show, beyond reasonable doubt, a team having discovered and/or exploited a vulnerability. The primary source of evidence is the events dataset [5]; however, in cases where we did not have enough evidence from the events dataset, we used the reports that the teams submitted to fill the gaps. These reports, submitted by the teams at the end of the competition, summarize the attacks that a team successfully accomplished. The evidence, when chronologically ordered, describes the process a team used to discover and/or exploit a vulnerability.\n\nThe approach, being manual, required us to sift through thousands of events from the dataset. Fortunately, knowledge of a particular known vulnerability helped considerably narrow down the number of events to analyze.\n\nWhile some vulnerabilities may be independently discovered, others are dependent on specific vulnerabilities having been previously discovered and exploited. For instance, the cleartext credentials in chat history vulnerability that Team 1 discovered is dependent on the MongoDB vulnerability. In gathering evidence, we also captured such dependency relationships between vulnerabilities.\n\nIn the case of some vulnerabilities, the discovery is achieved through exploit. As a result, the evidence gathered for such vulnerabilities show both discovery and exploit simultaneously. For instance, an attacker can discover the MongoDB vulnerability by actually connecting to the MongoDB instance from a remote host without providing any credentials (i.e. by exploiting the vulnerability).\n\nThe approach to gather evidence and collate it into a timeline is summarized below. We used Splunk Web Interface to query and/or filter events when gathering evidence.\n\n\nVictim's Perspective\n\nAt a high-level, the approach to gather evidence of an attack from the victim's perspective has five steps: (1) identify the victim; (2) filter events by victim; (3) enumerate source types; (4) evaluate events associated with each source type based on its hypothesized relevance; and (5) identify first instance of attack.\n\nIn our work, since the environment was controlled, the host targeted in an attack was known; we refer to this host as the victim. We used the identity of the victim to only consider events associated with the victim. We then enumerated the distinct source types that the events were associated with. We familiarized ourselves with the meaning of the source types enumerated and then used the specifics of the vulnerability to hypothesize source types likely to contain evidence of the attack. The guiding principle we used was granularity: events at application level were preferred to those at the network level. If a particular source type yielded no useful information, we moved to source types at a lower level of granularity until we had enough evidence to describe the attack. We were only interested in the first instance of the attack because subsequent attacks would be unlikely to include the discovery aspect of the attack. The events associated with the first instance of the attack provide two key pieces of information: (1) the timestamp of the attack and (2) the identity of the attacker.\n\nIn case of the MongoDB vulnerability, we know corp\\talk-00 was the victim. The dataset has 888,220 events associated with corp\\talk-00 across 45 distinct source types. Fortunately, corp\\talk-00 was instrumented with Suricata Intrusion Detection System (IDS), which was successful in identifying the attack as evidenced by a suricata:alert event. The suricata:alert event identified the first instance of the attack as originating from vdi\\t1-vdi-kali06 (the attacker) at 11/3/2018 11:15:41 AM EDT (the timestamp). If there was no IDS monitoring the host, we would have started our analysis with mongodb events which represent entries from the /var/log/mongodb/mongodb.log file. If mongodb events yielded no useful information, we would have moved on to netstat or stream:tcp events.\n\n\nAttacker's Perspective\n\nAt a high-level, the approach to gather evidence of an attack from the attacker's perspective is very similar to that which was used to gather evidence of the attack from the victim's perspective. However, the knowledge of the timestamp of the attack considerably reduces the number of events we have to sift through by providing an instant in time from which to work backwards to identify the attacker's actions. We were interested in identifying the attacker's action that directly led to the attack as we observed on the victim. Therefore, the event we were interested in would likely be at or near the timestamp of an event we identified on the victim. We use the term \"near\" here because some events are captured periodically. For instance, events associated with the ps source type are captured every 30 seconds, so a process invoked to exploit the vulnerability may not show up at the precise timestamp identified on the victim. The relevance of granularity is much more here than it was for the victim because describing the attacker's approach at the application level of granularity is much more insightful than at the network level.\n\nIn the case of the MongoDB vulnerability, working backwards from 11/3/2018 11:15:41 AM EDT, we found a ps event at 11/3/2018 11:13:06 AM EDT that showed the attacker had been running mongo --port 27017 10.0.0.20 command for 27 seconds which was likely the session that triggered the alert on the victim.\n\n\nTimeline of Events\n\nIn addition to the event(s) showing the attack from both the victim's and attacker's perspective, we need events to describe the discovery aspect if we were to characterize the holistic behavior of the attacker. We worked backward from the timestamp of the event showing the attacker successfully attacking the victim to identify events that can describe the approach the attacker used to discover the vulnerability. The approach to identify these discovery events were guided by us questioning every element in all events we had gathered so far. The search for events to characterize the discovery aspect of a vulnerability was restricted to the host used by the attacker.\n\nIn case of the MongoDB vulnerability, we knew that the attacker successfully attacked the victim as evidenced by the attacker running mongo --port 27017 10.0.0.20. However, to characterize the discovery aspect of the attack, we must gather evidence of the attacker identifying that (1) 10.0.0.20 was an address assigned to a host in the corp network and (2) port 27017 was open on the host. Analyzing the dataset to address these two questions, we found events showing that the attacker used onetwopunch [9] which internally invoked unicornscan [10] and nmap [11] in sequence to discover that port 27017 (the default MongoDB port) was open on a host accessible at 10.0.0.20 (the IP address assigned to the victim).\n\n\nB. Behavior Characterization\n\nThe evidence gathered provides a timeline to describe the way in which an attacker discovered and then exploited a vulnerability. While the timeline of events itself is quite useful, its granularity makes inferring generalizable attacker behavior rather difficult. To overcome this difficulty, we mapped each event in the attackers' timeline to tactics and techniques in the ATT&CK framework. The mapping provides a way to describe the attack at a higher level of granularity and, more importantly, from the perspective of an attacker.\n\nThe approach we used to map the events to ATT&CK tactics and techniques is summarized in this section. Since the number of ATT&CK techniques is much larger than the number of ATT&CK tactics, we first identified the ATT&CK tactic to reduce the number of ATT&CK techniques we had to evaluate.\n\nThe approach to map events to ATT&CK tactics and techniques, being manual, is subjective. We mitigated the subjectivity by having at least two authors perform the mapping of events to ATT&CK tactics and techniques and used Cohen's \u03ba, an inter-rater reliability measure, to quantify and reason about the level of agreement.\n\n\nATT&CK Tactic\n\nWe mapped an event to ATT&CK tactic by inferring the objective of the attacker from the evidence associated with the event. For instance, if we have evidence that the attacker ran nmap 10.0.0.20, we can infer, based on the utility of nmap [11], that the attacker was attempting to enumerate the open ports on 10.0.0.20. We used the inferred objective to identify the ATT&CK tactic, which, in the case of nmap 10.0.0.20 event would be discovery.\n\n\nATT&CK Technique\n\nWe mapped an event to an appropriate ATT&CK technique by using the description of the various techniques associated with the ATT&CK tactic previously identified and finding the one that closely matched that which the attacker used. For instance, to discover information about a host, the attacker used nmap which is a port scanning utility. The use of nmap is best described by the network service scanning ATT&CK technique which mentions the use of \"port scans\" as an approach for \"listing of services running on remote hosts\". 1 VI. RESULTS Question: What MITRE ATT&CK\u2122 tactics and techniques can be inferred from the competition data set?\n\nThe motivation for this research question is to assess if the events dataset has the information needed to characterize an attack from the perspective of the attacker.\n\nWe applied the methodology described in Section V to all the vulnerabilities discovered and/or exploited by Team 1. We found 47 events to describe Team 1 discovering and exploiting the seven vulnerabilities that were attributed to them. 44 of the 47 events were sourced from the events dataset, whereas, the remaining 3 events were sourced from the report that Team 1 submitted describing their campaign. 3 of the 47 events were captured merely to add context. For instance, the attackers used unauthenticated access to sensitive API to escalate the privileges of a compromised user account by adding the account to Administrators, Domain Administrators, and Remote Desktop Users groups. We captured an WinEventLog event merely to add context to the analysis by showing that the compromised user account was not part of these groups prior to the attack.\n\nWhen gathering evidence of attacks from the dataset, we noted dependencies between vulnerabilities. For instance, a Team 1 attacker had to exploit the MongoDB vulnerability and then the cleartext credentials in chat history vulnerability to gain access to valid employee credentials (one of two valid employee credentials that Team 1 uncovered). We clustered these dependencies into scenarios with each scenario having a tangible end goal for the attacker. In each scenario, the attacker has to successfully exploit one or more vulnerabilities and/or other scenarios in sequence to achieve the goal.\n\nWe identified five scenarios into which the seven vulnerabilities of Team 1 could be clustered into. These scenarios, along with their constituent vulnerabilities and/or other scenarios, are as follows: S1. Access to Valid Employee Credentials I: Unauthenticated remote administrator access to MongoDB and cleartext credentials in chat history. S2. Unfettered Access to Active Directory Infrastructure: Blank domain administrator password or unauthenticated access to sensitive API and scenario #1. S3. Access to Valid Employee Credentials II: Scenario #1, Scenario #2, and backup file on workstation. S4. Potential for Eavesdropping: No SSL on sensitive web application. S5. Access to Sensitive Internal Documentation: API documentation leaked on HeckForums.\n\nTwo authors independently mapped the 44 events (47 minus 3 events adding context) to ATT&CK tactics and techniques. The inter-rater reliability, measured by Cohen's \u03ba, between the two authors was 0.4890 (p-value < 0.05) for ATT&CK tactics and 0.4370 (p-value < 0.05) for ATT&CK techniques. The inter-rater reliability score is regarded as moderate agreement by Landis and Koch [12].\n\nIn terms of the ATT&CK tactic, the two authors disagreed on the mapping of 16 of the 44 (36%) events, 4 (25%) of which were resolved by combining the ATT&CK tactic mapped by both authors. In terms of the ATT&CK technique, the two authors disagreed on the mapping of 19 of the 44 (43%) events, 8 (42%) of which were resolved by combining the ATT&CK technique mapped by both authors.\n\nA common theme that emerged during the discussion of the disagreements was that mapping an event in isolation (i.e. disregarding the chronology of the events) often led to an incorrect mapping. For instance, a linux_secure event showed that a compromised user account was used to authenticate to a host in the network. In isolation, this event could be mapped as the attacker attempting initial access (tactic) using valid accounts (technique). However, if we use the knowledge that the attackers obtained the credentials to the compromised user account by exploiting another vulnerability, then we would map the event as the attacker attempting to move laterally (tactic) using valid accounts (technique). The role of subjectivity is quite pronounced and, therefore, there is a need to have at least two authors independently map the events to ATT&CK tactic and technique. In the future, we intend on having the disagreements be resolved by an expert well versed in penetration testing to further increase the validity of the mapping.\n\nOnce the disagreements were resolved, we chronologically ordered the ATT&CK tactics and techniques to provide an overview of the entire campaign of attack. Shown in Figure  1 is a flow diagram summarizing the approach, in terms of ATT&CK tactics and techniques, that Team 1 took to discover and exploit the vulnerabilities attributed to them. Each sequence of ATT&CK tactics and techniques in the diagram terminates at a tangible end goal for the attacker indicating the accomplishment of a scenario.\n\nAs seen in Figure 1, some vulnerabilities are trivial to attack, requiring a single step (often discovery using network service scanning) to discover. The characterization can not only inform the attacker mindset of engineers and administrators but also be used to reason about the extent of discoverability of vulnerabilities.\n\n\nVII. LIMITATIONS\n\nIn this section, we highlight possible limitations of our work and the steps taken to alleviate some of them.\n\n\nInternal Validity\n\nThere are two threats to internal validity in our work: completeness of the events dataset and methodological subjectivity.\n\nThe events dataset, though insightful, is not complete. There are certain actions of the attacker that is not represented by any event in the dataset. For instance, we know, from the report submitted, that Team 1 dumped a particular database after exploiting the MongoDB vulnerability. However, there is no event in the dataset to support this assertion. We overcame this limitation by using the information in the report that a team submitted to fill the gaps in the events dataset.\n\nThe approach we used to gather evidence from the events dataset to describe the timeline of an attack, being inherently manual, may have been affected by subjectivity. We could have had multiple authors independently gather evidence of an attack and compare the gathered evidence to assess the level of agreement (using an inter-rater reliability measure such as Cohen's \u03ba). However, since the purpose of gathering evidence of an attack is to implicate an attacker beyond reasonable doubt, the subjectivity is unlikely to be a limitation. In other words, the evidence gathered must be sufficient enough to describe the approach an attacker used to discover and exploit a vulnerability but its exhaustiveness is not an essential property. However, as we expand our analysis to include vulnerabilities discovered and exploited by the remaining teams, we intend to have an actual penetration tester gather evidence of attacks to assess if the subjectivity in gathering evidence has a nonnegligible impact on the resultant timeline of events.\n\n\nExternal Validity\n\nThe attack narratives derived from the events dataset represent the modus operandi of students playing the role of attackers. We cannot claim that these narratives represent the approach of a real adversary because of two key distinctions between students and adversaries: (1) students were provided initial access to the infrastructure that an adversary may not have and, more importantly, (2) students were not constrained by concerns of any legal ramifications from their actions. The role of students having been provided initial access is not entirely relevant as Casey and Willis [13] highlight the present reality of employees and contractors (i.e. insiders) carrying out the most damaging attacks on businesses.\n\n\nVIII. RELATED WORK\n\nThe ontological coding aspect of our work is inspired by the concept of attack narratives proposed by Mireles et al. [3]. Mireles et al. [3] Fig. 1. Chronological flow diagram summarizing the approach that Team 1 took to discover and exploit vulnerabilities attributed to them. The chronology is depicted in terms of ATT&CK tactics (in black) and corresponding techniques (in blue) with each sequence terminating at a scenario (in red).\n\nconstructing flow models of attacks from network traffic. In this study, we examine events from a broad variety of sources on the attacker and victim hosts. With this richer data set, we gain a more detailed timeline of events. For instance, the dataset not only has information to characterize if an attacker used port scanning but also the specific port scanning utility (nmap or unicornscan) that the attacker used with all of the command line flags they specified. The dataset eliminates the need to infer attacker behavior from network traffic by actually capturing the attackers' actions.\n\n\nIX. SUMMARY\n\nOur goal is to assist developers and administrators in inculcating an attacker mindset by proposing an approach to codify attacker behavior in cybersecurity penetration testing competition. We are in the process of analyzing a dataset of over 500 million events from six teams of attackers curated by Munaiah et al. [5] during the 2018 National Collegiate Penetration Testing Competition. We created detailed event timelines using the MITRE ATT&CK\u2122 framework to characterize and describe attacker behavior in a standard way. In our preliminary analysis, we found 44 events to characterize the modus operandi of one team of attackers that discovered and exploited seven vulnerabilities.\n\nWhile we demonstrate the feasibility of using empirical data to characterize attacker behavior, the analysis of vulnerabilities discovered and exploited by a single team is unlikely to yield generalizable insights about the behavior of a typical attacker. In our ongoing work, we are applying the methodology presented in this paper to characterize the behavior of the remaining teams of attackers. We envision the comparison of the modus operandi of multiple teams to reveal similarities in approach which can provide some generalizable insights on the typical ways in which weaknesses in software systems are discovered and exploited. We hope that such knowledge can inform the attacker mindset of engineers and administrators in their pursuit of engineering secure software systems.\n\n\ndescribed attacks as narratives byDiscovery \n\nCredential Access \n\nNetwork Service \nScanning \n\nBrute Force \n\nPrivilege Escalation \n\nExploitation for \nPrivilege Escalation \n\nCredential Access \n\nCredential Dumping \n\nAccess to Valid \nEmployee Credentials I \n\nCredential Access \n\nBrute Force \n\nUnfettered Access to Active \nDirectory Infrastructure \n\nLateral Movement \n\nValid Accounts and \nRemote Services \n\nValid Accounts \n\nDiscovery \n\nNetwork Share \nDiscovery \n\nPersistence \n\nCreate Account \n\nLateral Movement \n\nValid Accounts and \nRemote Desktop Protocol \n\nCredential Access \n\nCredentials in File \n\nAccess to Valid Employee \nCredentials II \n\nPotential for \nEavesdropping \nDiscovery \n\nBrute Force \n\nAccess to Sensitive \nInternal Documentation \n\nPrivilege Escalation \n\nPrivilege Escalation \n\nExploitation for \nPrivilege Escalation \n\nPersistence \n\nAccount \nManipulation \n\nS4 \n\nS1 \n\nS2 \n\nS3 \n\nS1 \n\nS2 \n\nS5 \n\n\nhttps://attack.mitre.org/techniques/T1046/\nACKNOWLEDGMENTS\nOpen Source Is Everywhere and So Are Vulnerabilities. J M Germain, Says Black Duck ReportJ. M. Germain, \"Open Source Is Everywhere and So Are Vulnerabilities, Says Black Duck Report,\" Accessed: June 10, 2019. [Online]. Available: https://www.linuxinsider.com/story/85338.html\n\nLearning Attack Strategies from Intrusion Alerts. P Ning, D Xu, 10.1145/948109.948137Proceedings of the 10th ACM Conference on Computer and Communications Security, ser. CCS '03. the 10th ACM Conference on Computer and Communications Security, ser. CCS '03New York, NY, USAACMP. Ning and D. Xu, \"Learning Attack Strategies from Intrusion Alerts,\" in Proceedings of the 10th ACM Conference on Computer and Communications Security, ser. CCS '03. New York, NY, USA: ACM, 2003, pp. 200-209. [Online]. Available: http://doi.acm.org/10. 1145/948109.948137\n\nExtracting Attack Narratives from Traffic Datasets. J D Mireles, J Cho, S Xu, 2016 International Conference on Cyber Conflict. CyCon U.S.J. D. Mireles, J. Cho, and S. Xu, \"Extracting Attack Narratives from Traffic Datasets,\" in 2016 International Conference on Cyber Conflict (CyCon U.S.), Oct 2016, pp. 1-6.\n\nFinding Cyber Threats with ATT&CK\u2122-Based Analytics. B E Strom, J A Battaglia, M S Kemmerer, W Kupersanin, D P Miller, C Wampler, S M Whitley, R D Wolf, The MITRE Corporation. Tech. RepB. E. Strom, J. A. Battaglia, M. S. Kemmerer, W. Kupersanin, D. P. Miller, C. Wampler, S. M. Whitley, and R. D. Wolf, \"Finding Cyber Threats with ATT&CK\u2122-Based Analytics,\" The MITRE Corporation, Tech. Rep., 2017. [Online]. Available: https://www.mitre.org/sites/ default/files/publications/16-3713-finding-cyber-threats with att&ck- based-analytics.pdf\n\nA Cybersecurity Dataset Derived from the National Collegiate Penetration Testing Competition. N Munaiah, J Pelletier, S.-H Su, S J Yang, A Meneely, HICSS Symposium on Cybersecurity Big Data Analytics. N. Munaiah, J. Pelletier, S.-H. Su, S. J. Yang, and A. Meneely, \"A Cybersecurity Dataset Derived from the National Collegiate Penetration Testing Competition,\" in HICSS Symposium on Cybersecurity Big Data Analytics, Nov 2019.\n\nAPT1: Exposing One of China's Cyber Espionage Units. Mandiant Consulting, Services, FireEye, IncTech. Rep.Mandiant Consulting Services, \"APT1: Exposing One of China's Cyber Espionage Units,\" FireEye, Inc., Tech. Rep., 2013. [Online].\n\nCyber Kill Chain\u00ae -Lockheed Martin. Lockheed Martin, AccessedLockheed Martin, \"Cyber Kill Chain\u00ae -Lockheed Martin,\" Accessed: June 3, 2019. [Online]. Available: https://www.lockheedmartin.com/en- us/capabilities/cyber/cyber-kill-chain.html\n\nB E Strom, A Applebaum, D P Miller, K C Nickels, A G Pennington, C B Thomas, MITRE ATT&CK\u2122: Design and Philosophy. B. E. Strom, A. Applebaum, D. P. Miller, K. C. Nickels, A. G. Pennington, and C. B. Thomas, \"MITRE ATT&CK\u2122: Design and Philosophy,\" The MITRE Corporation, Tech. Rep., 2018. [Online].\n\n. H Rodriguez, onetwopunchH. Rodriguez, \"onetwopunch,\" Accessed: June 5, 2019. [Online].\n\n. J Louis, unicornscanJ. Louis, \"unicornscan,\" Accessed: June 5, 2019. [Online].\n\nAccessed. G Lyon, G. Lyon, \"nmap,\" Accessed: June 5, 2019. [Online]. Available: https://linux.die.net/man/1/nmap\n\nThe Measurement of Observer Agreement for Categorical Data. J R Landis, G G Koch, Biometrics. 331J. R. Landis and G. G. Koch, \"The Measurement of Observer Agreement for Categorical Data,\" Biometrics, vol. 33, no. 1, pp. 159-174, 1977. [Online]. Available: http://www.jstor.org/stable/2529310\n\nWargames: Serious Play that Tests Enterprise Security Assumptions. T Casey, B Willis, Intel Corporation. Tech. RepT. Casey and B. Willis, \"Wargames: Serious Play that Tests Enterprise Security Assumptions,\" Intel Corporation, Tech. Rep., 2017. [Online].\n", "annotations": {"author": "[{\"end\":102,\"start\":87},{\"end\":182,\"start\":103},{\"end\":200,\"start\":183},{\"end\":287,\"start\":201},{\"end\":303,\"start\":288},{\"end\":356,\"start\":304}]", "publisher": null, "author_last_name": "[{\"end\":101,\"start\":94},{\"end\":115,\"start\":109},{\"end\":199,\"start\":190},{\"end\":216,\"start\":208},{\"end\":302,\"start\":295}]", "author_first_name": "[{\"end\":93,\"start\":87},{\"end\":108,\"start\":103},{\"end\":189,\"start\":183},{\"end\":207,\"start\":201},{\"end\":294,\"start\":288}]", "author_affiliation": "[{\"end\":181,\"start\":135},{\"end\":286,\"start\":240},{\"end\":355,\"start\":305}]", "title": "[{\"end\":84,\"start\":1},{\"end\":440,\"start\":357}]", "venue": null, "abstract": "[{\"end\":1802,\"start\":481}]", "bib_ref": "[{\"attributes\":{\"ref_id\":\"b0\"},\"end\":2426,\"start\":2423},{\"attributes\":{\"ref_id\":\"b1\"},\"end\":3338,\"start\":3335},{\"attributes\":{\"ref_id\":\"b2\"},\"end\":3343,\"start\":3340},{\"attributes\":{\"ref_id\":\"b3\"},\"end\":3628,\"start\":3625},{\"attributes\":{\"ref_id\":\"b4\"},\"end\":3681,\"start\":3678},{\"attributes\":{\"ref_id\":\"b4\"},\"end\":4409,\"start\":4406},{\"attributes\":{\"ref_id\":\"b4\"},\"end\":4813,\"start\":4810},{\"attributes\":{\"ref_id\":\"b4\"},\"end\":5055,\"start\":5052},{\"attributes\":{\"ref_id\":\"b5\"},\"end\":10187,\"start\":10184},{\"attributes\":{\"ref_id\":\"b6\"},\"end\":10228,\"start\":10225},{\"attributes\":{\"ref_id\":\"b3\"},\"end\":10319,\"start\":10316},{\"attributes\":{\"ref_id\":\"b3\"},\"end\":10668,\"start\":10665},{\"attributes\":{\"ref_id\":\"b7\"},\"end\":10831,\"start\":10828},{\"attributes\":{\"ref_id\":\"b4\"},\"end\":12840,\"start\":12837},{\"attributes\":{\"ref_id\":\"b8\"},\"end\":19325,\"start\":19322},{\"attributes\":{\"ref_id\":\"b9\"},\"end\":19367,\"start\":19363},{\"attributes\":{\"ref_id\":\"b10\"},\"end\":19381,\"start\":19377},{\"attributes\":{\"ref_id\":\"b10\"},\"end\":20977,\"start\":20973},{\"attributes\":{\"ref_id\":\"b11\"},\"end\":24609,\"start\":24605},{\"attributes\":{\"ref_id\":\"b12\"},\"end\":29273,\"start\":29269},{\"attributes\":{\"ref_id\":\"b2\"},\"end\":29545,\"start\":29542},{\"attributes\":{\"ref_id\":\"b2\"},\"end\":29565,\"start\":29562},{\"attributes\":{\"ref_id\":\"b4\"},\"end\":30792,\"start\":30789}]", "figure": "[{\"attributes\":{\"id\":\"tab_0\",\"type\":\"table\"},\"end\":32849,\"start\":31946}]", "paragraph": "[{\"end\":2427,\"start\":1821},{\"end\":2762,\"start\":2429},{\"end\":3308,\"start\":2764},{\"end\":3919,\"start\":3310},{\"end\":4697,\"start\":3921},{\"end\":5976,\"start\":4713},{\"end\":6549,\"start\":5978},{\"end\":7141,\"start\":6551},{\"end\":7750,\"start\":7166},{\"end\":7978,\"start\":7752},{\"end\":8513,\"start\":7980},{\"end\":8985,\"start\":8515},{\"end\":9536,\"start\":8987},{\"end\":9674,\"start\":9538},{\"end\":10401,\"start\":9676},{\"end\":10669,\"start\":10403},{\"end\":10970,\"start\":10700},{\"end\":11682,\"start\":10972},{\"end\":12359,\"start\":11684},{\"end\":12631,\"start\":12378},{\"end\":13237,\"start\":12657},{\"end\":13456,\"start\":13239},{\"end\":13846,\"start\":13458},{\"end\":14240,\"start\":13848},{\"end\":14409,\"start\":14242},{\"end\":14756,\"start\":14434},{\"end\":15861,\"start\":14758},{\"end\":16645,\"start\":15863},{\"end\":17815,\"start\":16672},{\"end\":18120,\"start\":17817},{\"end\":18816,\"start\":18143},{\"end\":19532,\"start\":18818},{\"end\":20100,\"start\":19565},{\"end\":20392,\"start\":20102},{\"end\":20716,\"start\":20394},{\"end\":21178,\"start\":20734},{\"end\":21840,\"start\":21199},{\"end\":22009,\"start\":21842},{\"end\":22864,\"start\":22011},{\"end\":23465,\"start\":22866},{\"end\":24226,\"start\":23467},{\"end\":24610,\"start\":24228},{\"end\":24993,\"start\":24612},{\"end\":26030,\"start\":24995},{\"end\":26532,\"start\":26032},{\"end\":26861,\"start\":26534},{\"end\":26991,\"start\":26882},{\"end\":27136,\"start\":27013},{\"end\":27621,\"start\":27138},{\"end\":28661,\"start\":27623},{\"end\":29402,\"start\":28683},{\"end\":29861,\"start\":29425},{\"end\":30457,\"start\":29863},{\"end\":31158,\"start\":30473},{\"end\":31945,\"start\":31160}]", "formula": null, "table_ref": null, "section_header": "[{\"end\":1819,\"start\":1804},{\"end\":4711,\"start\":4700},{\"end\":7164,\"start\":7144},{\"end\":10698,\"start\":10672},{\"end\":12376,\"start\":12362},{\"end\":12655,\"start\":12634},{\"end\":14432,\"start\":14412},{\"end\":16670,\"start\":16648},{\"end\":18141,\"start\":18123},{\"end\":19563,\"start\":19535},{\"end\":20732,\"start\":20719},{\"end\":21197,\"start\":21181},{\"end\":26880,\"start\":26864},{\"end\":27011,\"start\":26994},{\"end\":28681,\"start\":28664},{\"end\":29423,\"start\":29405},{\"end\":30471,\"start\":30460}]", "table": "[{\"end\":32849,\"start\":31982}]", "figure_caption": "[{\"end\":31982,\"start\":31948}]", "figure_ref": "[{\"end\":26206,\"start\":26197},{\"end\":26553,\"start\":26545},{\"end\":29572,\"start\":29566}]", "bib_author_first_name": "[{\"end\":32964,\"start\":32963},{\"end\":32966,\"start\":32965},{\"end\":33237,\"start\":33236},{\"end\":33245,\"start\":33244},{\"end\":33790,\"start\":33789},{\"end\":33792,\"start\":33791},{\"end\":33803,\"start\":33802},{\"end\":33810,\"start\":33809},{\"end\":34100,\"start\":34099},{\"end\":34102,\"start\":34101},{\"end\":34111,\"start\":34110},{\"end\":34113,\"start\":34112},{\"end\":34126,\"start\":34125},{\"end\":34128,\"start\":34127},{\"end\":34140,\"start\":34139},{\"end\":34154,\"start\":34153},{\"end\":34156,\"start\":34155},{\"end\":34166,\"start\":34165},{\"end\":34177,\"start\":34176},{\"end\":34179,\"start\":34178},{\"end\":34190,\"start\":34189},{\"end\":34192,\"start\":34191},{\"end\":34680,\"start\":34679},{\"end\":34691,\"start\":34690},{\"end\":34707,\"start\":34703},{\"end\":34713,\"start\":34712},{\"end\":34715,\"start\":34714},{\"end\":34723,\"start\":34722},{\"end\":35292,\"start\":35284},{\"end\":35490,\"start\":35489},{\"end\":35492,\"start\":35491},{\"end\":35501,\"start\":35500},{\"end\":35514,\"start\":35513},{\"end\":35516,\"start\":35515},{\"end\":35526,\"start\":35525},{\"end\":35528,\"start\":35527},{\"end\":35539,\"start\":35538},{\"end\":35541,\"start\":35540},{\"end\":35555,\"start\":35554},{\"end\":35557,\"start\":35556},{\"end\":35791,\"start\":35790},{\"end\":35881,\"start\":35880},{\"end\":35971,\"start\":35970},{\"end\":36135,\"start\":36134},{\"end\":36137,\"start\":36136},{\"end\":36147,\"start\":36146},{\"end\":36149,\"start\":36148},{\"end\":36435,\"start\":36434},{\"end\":36444,\"start\":36443}]", "bib_author_last_name": "[{\"end\":32974,\"start\":32967},{\"end\":33242,\"start\":33238},{\"end\":33248,\"start\":33246},{\"end\":33800,\"start\":33793},{\"end\":33807,\"start\":33804},{\"end\":33813,\"start\":33811},{\"end\":34108,\"start\":34103},{\"end\":34123,\"start\":34114},{\"end\":34137,\"start\":34129},{\"end\":34151,\"start\":34141},{\"end\":34163,\"start\":34157},{\"end\":34174,\"start\":34167},{\"end\":34187,\"start\":34180},{\"end\":34197,\"start\":34193},{\"end\":34688,\"start\":34681},{\"end\":34701,\"start\":34692},{\"end\":34710,\"start\":34708},{\"end\":34720,\"start\":34716},{\"end\":34731,\"start\":34724},{\"end\":35085,\"start\":35066},{\"end\":35095,\"start\":35087},{\"end\":35299,\"start\":35293},{\"end\":35498,\"start\":35493},{\"end\":35511,\"start\":35502},{\"end\":35523,\"start\":35517},{\"end\":35536,\"start\":35529},{\"end\":35552,\"start\":35542},{\"end\":35564,\"start\":35558},{\"end\":35801,\"start\":35792},{\"end\":35887,\"start\":35882},{\"end\":35976,\"start\":35972},{\"end\":36144,\"start\":36138},{\"end\":36154,\"start\":36150},{\"end\":36441,\"start\":36436},{\"end\":36451,\"start\":36445}]", "bib_entry": "[{\"attributes\":{\"id\":\"b0\"},\"end\":33184,\"start\":32909},{\"attributes\":{\"doi\":\"10.1145/948109.948137\",\"id\":\"b1\",\"matched_paper_id\":7479770},\"end\":33735,\"start\":33186},{\"attributes\":{\"id\":\"b2\",\"matched_paper_id\":17439399},\"end\":34045,\"start\":33737},{\"attributes\":{\"id\":\"b3\",\"matched_paper_id\":11053302},\"end\":34583,\"start\":34047},{\"attributes\":{\"id\":\"b4\",\"matched_paper_id\":259257394},\"end\":35011,\"start\":34585},{\"attributes\":{\"id\":\"b5\"},\"end\":35246,\"start\":35013},{\"attributes\":{\"id\":\"b6\"},\"end\":35487,\"start\":35248},{\"attributes\":{\"id\":\"b7\"},\"end\":35786,\"start\":35489},{\"attributes\":{\"id\":\"b8\"},\"end\":35876,\"start\":35788},{\"attributes\":{\"id\":\"b9\"},\"end\":35958,\"start\":35878},{\"attributes\":{\"id\":\"b10\"},\"end\":36072,\"start\":35960},{\"attributes\":{\"id\":\"b11\",\"matched_paper_id\":11077516},\"end\":36365,\"start\":36074},{\"attributes\":{\"id\":\"b12\"},\"end\":36620,\"start\":36367}]", "bib_title": "[{\"end\":33234,\"start\":33186},{\"end\":33787,\"start\":33737},{\"end\":34097,\"start\":34047},{\"end\":34677,\"start\":34585},{\"end\":36132,\"start\":36074},{\"end\":36432,\"start\":36367}]", "bib_author": "[{\"end\":32976,\"start\":32963},{\"end\":33244,\"start\":33236},{\"end\":33250,\"start\":33244},{\"end\":33802,\"start\":33789},{\"end\":33809,\"start\":33802},{\"end\":33815,\"start\":33809},{\"end\":34110,\"start\":34099},{\"end\":34125,\"start\":34110},{\"end\":34139,\"start\":34125},{\"end\":34153,\"start\":34139},{\"end\":34165,\"start\":34153},{\"end\":34176,\"start\":34165},{\"end\":34189,\"start\":34176},{\"end\":34199,\"start\":34189},{\"end\":34690,\"start\":34679},{\"end\":34703,\"start\":34690},{\"end\":34712,\"start\":34703},{\"end\":34722,\"start\":34712},{\"end\":34733,\"start\":34722},{\"end\":35087,\"start\":35066},{\"end\":35097,\"start\":35087},{\"end\":35301,\"start\":35284},{\"end\":35500,\"start\":35489},{\"end\":35513,\"start\":35500},{\"end\":35525,\"start\":35513},{\"end\":35538,\"start\":35525},{\"end\":35554,\"start\":35538},{\"end\":35566,\"start\":35554},{\"end\":35803,\"start\":35790},{\"end\":35889,\"start\":35880},{\"end\":35978,\"start\":35970},{\"end\":36146,\"start\":36134},{\"end\":36156,\"start\":36146},{\"end\":36443,\"start\":36434},{\"end\":36453,\"start\":36443}]", "bib_venue": "[{\"end\":32961,\"start\":32909},{\"end\":33363,\"start\":33271},{\"end\":33862,\"start\":33815},{\"end\":34220,\"start\":34199},{\"end\":34784,\"start\":34733},{\"end\":35064,\"start\":35013},{\"end\":35282,\"start\":35248},{\"end\":35602,\"start\":35566},{\"end\":35968,\"start\":35960},{\"end\":36166,\"start\":36156},{\"end\":36470,\"start\":36453},{\"end\":33459,\"start\":33365},{\"end\":33874,\"start\":33864}]"}}}, "year": 2023, "month": 12, "day": 17}