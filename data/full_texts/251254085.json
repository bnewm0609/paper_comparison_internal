{"id": 251254085, "updated": "2022-10-11 01:11:36.325", "metadata": {"title": "Multinational Federated Learning Approach to Train ECG and Echocardiogram Models for Hypertrophic Cardiomyopathy Detection", "authors": "[{\"first\":\"Shinichi\",\"last\":\"Goto\",\"middle\":[]},{\"first\":\"Divyarajsinhji\",\"last\":\"Solanki\",\"middle\":[]},{\"first\":\"Jenine\",\"last\":\"John\",\"middle\":[\"E.\"]},{\"first\":\"Ryuichiro\",\"last\":\"Yagi\",\"middle\":[]},{\"first\":\"Max\",\"last\":\"Homilius\",\"middle\":[]},{\"first\":\"Genki\",\"last\":\"Ichihara\",\"middle\":[]},{\"first\":\"Yoshinori\",\"last\":\"Katsumata\",\"middle\":[]},{\"first\":\"Hanna\",\"last\":\"Gaggin\",\"middle\":[\"K.\"]},{\"first\":\"Yuji\",\"last\":\"Itabashi\",\"middle\":[]},{\"first\":\"Calum\",\"last\":\"MacRae\",\"middle\":[\"A.\"]},{\"first\":\"Rahul\",\"last\":\"Deo\",\"middle\":[\"C.\"]}]", "venue": "Circulation", "journal": "Circulation", "publication_date": {"year": 2022, "month": null, "day": null}, "abstract": "Background: Novel targeted treatments increase the need for prompt hypertrophic cardiomyopathy (HCM) detection. However, its low prevalence (0.5%) and resemblance to common diseases present challenges that may benefit from automated machine learning\u2013based approaches. We aimed to develop machine learning models to detect HCM and to differentiate it from other cardiac conditions using ECGs and echocardiograms, with robust generalizability across multiple cohorts. Methods: Single-institution HCM ECG models were trained and validated on external data. Multi-institution models for ECG and echocardiogram were trained on data from 3 academic medical centers in the United States and Japan using a federated learning approach, which enables training on distributed data without data sharing. Models were validated on held-out test sets for each institution and from a fourth academic medical center and were further evaluated for discrimination of HCM from aortic stenosis, hypertension, and cardiac amyloidosis. Last, automated detection was compared with manual interpretation by 3 cardiologists on a data set with a realistic HCM prevalence. Results: We identified 74\u2009376 ECGs for 56\u2009129 patients and 8392 echocardiograms for 6825 patients at the 4 academic medical centers. Although ECG models trained on data from each institution displayed excellent discrimination of HCM on internal test data (C statistics, 0.88\u20130.93), the generalizability was limited, most notably for a model trained in Japan and tested in the United States (C statistic, 0.79\u20130.82). When trained in a federated manner, discrimination of HCM was excellent across all institutions (C statistics, 0.90\u20130.96 and 0.90\u20130.96 for ECG and echocardiogram model, respectively), including for phenotypic subgroups. The models further discriminated HCM from hypertension, aortic stenosis, and cardiac amyloidosis (C statistics, 0.84, 0.83, and 0.88, respectively, for ECG and 0.93, 0.94, 0.85, respectively, for echocardiogram). Analysis of electrocardiography-echocardiography paired data from 11\u2009823 patients from an external institution indicated a higher sensitivity of automated HCM detection at a given positive predictive value compared with cardiologists (0.98 versus 0.81 at a positive predictive value of 0.01 for ECG and 0.78 versus 0.59 at a positive predictive value of 0.24 for echocardiogram). Conclusions: Federated learning improved the generalizability of models that use ECGs and echocardiograms to detect and differentiate HCM from other causes of hypertrophy compared with training within a single institution.", "fields_of_study": "[\"Medicine\"]", "external_ids": {"arxiv": null, "mag": null, "acl": null, "pubmed": "35916132", "pubmedcentral": "9439630", "dblp": null, "doi": "10.1161/circulationaha.121.058696"}}, "content": {"source": {"pdf_hash": "bd44d3310a04aa83e15f0ca4d1a8fd8e87fe73c2", "pdf_src": "PubMedCentral", "pdf_uri": null, "oa_url_match": false, "oa_info": {"license": "CCBYNCND", "open_access_url": "https://www.ahajournals.org/doi/pdf/10.1161/CIRCULATIONAHA.121.058696", "status": "HYBRID"}}, "grobid": {"id": "6f4444f0be47494225d7fa39ec0b09a8d5910d09", "type": "plain-text", "url": "s3://ai2-s2-pdf-extraction-prod/parse-results/s2orc_worker/bd44d3310a04aa83e15f0ca4d1a8fd8e87fe73c2.txt", "contents": "\n\n\n\nbar of 15 mm for each video, age, and sex of the patients and assigned a binary label for suspicion of HCM. The experts were blinded to the status of HCM, the output of ML models. While RY and SG independently labeled the echocardiogram, JJ overread the lab labels given by RY.Software environmentData were collected and stored using NumPy package version 1.21.0 with Python 3.9.5. All the models were trained with pytorch 1.9.0. The ROC plots and PRC plots were plotted using the ggplot2 package (R 3.6.1) and the C-statistic, sensitivity, specificity, and 95% confidence intervals were calculated using the pROC package (1.16.2).Code availability.The code for training and testing the model is provided at https://github.com/obi-ml-public/echo-ai-HCM-detection. The model weights may contain patient personal information and thus, could not be shared. We provide a web-interface to run our model and generate predictions at\n\nSUPPLEMENTAL MATERIAL\n\n\nSupplemental Methods\n\n\nGRAD-CAM imaging\n\nGRAD-CAM is a technology to visualize activation patterns in the hidden layer of neural network to assist the understanding of features used by the model to perform classification. We used the technology to the ECG and echocardiogram models trained in a federated manner. For the ECG model, the GRAD-CAM maps were obtained as 1D vector for each lead and overlayed on the corresponding leads after plotting of the ECG as waveforms. For the echocardiogram model, the GRAD-CAM maps were obtained as 3D matrices with each dimension corresponding to x, y and time axis. These maps were overlayed on the original videos.\n\n\nCase control matching for ECGs and echocardiograms\n\nTo facilitate the models to learn features specific to HCM independent of age and sex, the cases and controls were matched based on age and sex. Since there was a much larger numbers of samples for controls, a single case ECG could match to multiple controls simultaneously. In such case, a random one was selected from matching candidates. To identify the best matching ratio between cases and controls, ECG models were trained with data produced with different matching ratios. The analysis revealed highest AUROC at 1:5 matching for ECG and 1:3 matching for echocardiogram for all institutions and thus we used these ratios for all further analysis ( Figure S28).\n\n\nECG preprocessing\n\nSince there were ECG recorded with 3 different sampling rates (240 Hz, 250 Hz and 500 Hz), recordings of 240 Hz and 500 Hz ECG were upsampled and subsampled respectively, to match 250 Hz sampling. Subsampling for 500 Hz was done by taking only the data points from every 4 ms (while the original recording had recording for every 2 ms). The upsampling of 240 Hz to 250 Hz was done by linear interpolation.\n\n\nModel aggregation in federated learning\n\nA neural network has internal parameters used to calculate the output from input data (similar to the coefficient of logistic regression model). In the training process, these parameters are updated to minimize the difference between the output and the label. Models trained on different datasets usually have different internal parameters even if the model is trained to do the same task. In federated learning, an integrated model is calculated each step by aggregating the internal parameters of the model trained on separate datasets. In our case, the aggregation was done by taking the weighted mean of the internal parameters, where the weights were constructed proportionally to the number of samples within each institution.\n\n\nPreprocessing of the echocardiogram videos\n\nSince echocardiograms have variable size, frame rate and length, the videos were standardized to a framerate of 30 fps by subsampling frames. Videos with a framerate lower than 30 fps were excluded.\n\nA uniform size input was created by padding the shorter edge of the video with 0 (black color), making the aspect ratio 1:1 and resizing to 299 x 299. Thirty consecutive frames were selected, with the first frame chosen randomly. Videos with fewer than 30 frames after conversion to 30 fps were excluded.\n\nThe processing resulted in a 3-dimensional matrix of 30 x 299 x 299 pixels and was saved as a NumPy array.\n\nBaseline models to discriminate HCM using common ECG measurements and baseline characteristics of patients recorded as tabular data.\n\nTo assess the baseline performance for discriminating HCM using basic ECG measurements and patient characteristics as tabular data, we trained and tested 3 logistic regression models and a random forest model using age, sex, heart rate, PR interval, QRS duration, corrected QT interval, amplitudes of R wave in V5 and V6 and amplitudes of S wave in V1 and V2. The 3 logistic regression models included different orders of interactions (none to 2 nd order interactions). The random forest model was trained to evaluate the contribution of the non-linearity of the inputs. To allow direct comparison, the models were trained using the characteristics from the same split of ECGs used to train federated-learning model and tested on the same test sets along with the external datasets. The leads for the amplitudes were selected to match those used for standard voltage criteria to evaluate left ventricular hypertrophy on a 12-lead ECG.\n\nBaseline models to discriminate HCM using common echocardiogram measurements and baseline characteristics of patients recorded as tabular data.\n\nAs with the ECG model, 3 logistic regression models and a random forest model was trained to assess the baseline performance for discriminating HCM from baseline echocardiogram measurements and baseline characteristics of patients as tabular data. As with the ECG, the models were trained using the characteristics from the same split of echocardiograms used to train the federated-learning model and tested on the same test sets along with the external datasets to allow direct comparison. Data from Keio University was excluded from the training dataset and analysis since the method for measuring left ventricular interventricular septum thickness was different. We trained and tested the models using age, sex, heart rate, left ventricular diameter at diastole, ejection fraction, left ventricle posterior wall thickness and left ventricular interventricular septum thickness.\n\n\nArchitecture of the neural network for the ECG model.\n\nTo effectively learn 12-lead ECG data, the data were interpreted as 2D data considering the leads as one dimension and time as the other. To learn this data structure, the architecture of the neural network consisted of multiple layers of 2D-CNN layers. Inspired by the inception network version 2, a multi-2D-CNN unit was constructed by performing different combinations of 2D-CNN layers concatenated at the end. For each of such multi-2D-CNN units, the input to it is also passed through one more 2D-CNN layer. Output of this layer is added to the concatenated output mentioned earlier. This allows more efficient flow of information through the network. The final model consisted of a single layer of 7x3 2D-CNN layers and 20 layers of multi-2D-CNN units ( Figure S29). The numbers of trainable parameters of the model were 26,260,079.\n\n\nArchitecture of the neural network for the echocardiogram model.\n\nTo learn the dynamic feature of the video for echocardiogram, the echocardiogram video was interpreted as 3D data considering the time as the 3 rd axis. The architecture of the neural network consisted of multiple layers of 3D-CNN layers. As with the ECG model, the architecture was inspired by the inception network version 2 and utilized multi-3D-CNN unit, which was constructed by performing different combinations of 3D-CNN layers concatenated at the end. For each of such multi-3D-CNN units, the input to it is also passed through one more 3D-CNN layer. Output of this layer is added to the concatenated output mentioned earlier. The final model consisted of a single layer of 7x7x7 3D-CNN layers and 12 layers of multi-3D-CNN units ( Figure S30). The numbers of trainable parameters of the model were 2,250,541.\n\n\nDetection of HCM from ECG by cardiologists\n\nCardiologists at different stages of their carrier (a cardiology fellow, a general cardiologist, and a cardiologist with US board certification in cardiology and echocardiogram) participated in the labeling of ECG. Since specifically detecting HCM from ECG is not a standard practice, ECGs were labeled with 3 criteria: any abnormal ECG (including abnormal voltage, arrythmia, T-wave abnormality etc.); voltage criteria for LVH; and suspicion for HCM (the criteria was left to the discretion of the labeling physician). The experts had access to the 12-lead ECG, age, and sex of the patients and assigned a binary label for each criterion. The experts were blinded to the status of HCM and the output of ML models. While RY and SG independently labeled the ECG, JJ overread the labels given by RY.\n\n\nDetection of HCM from echocardiogram by cardiologists\n\nThe same cardiologists as with the ECG labeling participated in the labeling of echocardiogram. For echocardiogram, the labeling was done with a single criterion (is HCM suspected from the echocardiogram or not). The experts had access to all the videos in the echocardiogram study, a scale\n\n\nSupplemental Results\n\n\nSubgroup analyses of models trained on ECGs from individual institutions\n\nTo explore the reason for lower generalizability of HCM discrimination for some models, we performed subgroup analyses on age, sex, heart rate and race using the dataset from eternal institution (BWH).\n\nWhile the models discriminated HCM better in lower age groups, female gender, and non-white population, the patterns of discrimination were similar across all models ( Figure S9).\n\n\nComparisons of ECG-HCM model with cardiologists to detect HCM.\n\nGiven that ECG could not be used as a definitive diagnostic for HCM, the purpose of using ECG for screening HCM is to capture patients who need further evaluation including echocardiograms. The chance of receiving echocardiogram for an abnormal ECG depends on multiple factors including the capacity of echocardiogram in that institution and the type of abnormality detected in the ECG. If the patient was not considered for further evaluation, they will be missed. Thus, the ability to flag HCM patients to receive further evaluation (which is reflected in sensitivity) is of vital importance. To evaluate this ability at different capacity to perform echocardiogram, the sensitivity of the ECG-HCM model to detect HCM was compared with cardiologists using 3 different criteria (any abnormal ECG, voltage criteria for LVH and suspicion for HCM) assuming that the latter criteria will provide higher yield in echocardiogram (represented in PPV) at the cost of reduced sensitivity. Using ECGs alone, cardiologists identified 73-81% of HCM patients at PPV of 1% with the any abnormal ECG criteria. As expected, other criteria for ECG displayed higher PPV of (6-14% and 13-22% for voltage criteria of LVH and suspected HCM, respectively) but had lower sensitivity (17-47 and 8-17% for voltage criteria of LVH and suspected HCM by experts, respectively). In comparison, when cutoffs were adjusted to achieve the same or higher PPV as the experts, the ECG ML model consistently showed higher sensitivities (sensitivities 98%, 63%, 51% at PPVs 1%, 10%, 22%, respectively).\n\n\n6\n\nSupplemental Tables.           ( Figure S1. Schematic of the structure of ECG data.\n9 (0.4) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) SonoSite 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) ATL 0 (0.0) 0 (0.0) 2 (0.4) 4 (0.3) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) MINDRAY 0 (0.0) 1 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) Toshiba 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0) 0 (0.0\nECGs are usually understood as images with wave forms (top). However, the raw representation of the data is a vector of voltages recorded in time series per each lead(middle  Figure S2. Schematic of the ECG data conversion for UMAP analysis.\n\nA recording of 12-lead ECG is a 2D matrix with a shape of 12 x 2500 with voltage recording. Since UMAP takes vectors rather than matrices as input, the 2D matrix of ECG was separated by each lead to 12 vectors of voltage recording (length 2500) and concatenated with the following order: I, II, III, aVR, aVL, aVF, V1, V2, V3, V4, V5 and V6 to a vector of length 30000 (12 x 2500         Net benefit is calculated as (true positive -false positive x odds at the threshold) / numbers of samples. \n\n\nOnly mutants classified as pathologic or likely pathologic are considered positive. The numbers represent the number of studies. NA: not available, HR: heart rate, BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital, PG: pressure gradient, VT: ventricular tachycardia, VF: ventricular fibrillation, MRI: magnetic resonance imaging.\n\n\naortic valve, AS: aortic valve stenosis, PG: pressure gradient, NA: not applicable, LVDd: left ventricular end-diastolic diameter, LVEF: left ventricular ejection fraction, PWT: posterior wall thickness, IVST: interventricular septum thickness, HR: heart rate\n\n\nshown as AUCROC (95% confidence interval). Data from Keio University Hospital were excluded from this analysis due to different measurement criteria for the ventricular wall thickness. BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, AUROC: area under the receiver operating characteristics curve.\n\n\nmutants classified as pathologic or likely pathologic are considered positive. HR are shown as the mean of ECG and echocardiogram. NA: not available, PG: pressure gradient. BWH: Brigham and Women's Hospital, HR: heart rate, IVST: interventricular septum thickness, PWT: posterior wall thickness, LVDd: left ventricular dimension in diastole, EF: ejection fraction.\n\nFigure S8 .Figure S9 .\nS8S9Discrimination of HCM by ECG model trained on data from Keio stratified by UMAP geometric regions. (A) Definition of geometric region on UMAP. Group 1 represents the area overlapping with data from Keio and Group2 is the area without overlap with Keio data. (B) AUROC of the model trained on Keio ECG tested on external institutions stratified by the geometric groups. The error bar represents the 95% confidence interval. AUROC: area under the receiver operating characteristics curve. BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital. Subgroup analyses of HCM discrimination on external dataset by ECG model trained at individual institutions stratified by various patient characteristicsAUROC values for HCM discrimination with the ECG models trained at individual institution tested on data from BWH stratified by patient characteristics of age, sex, heart rate and race. The error bar represents the 95% confidence interval. AUROC: area under the receiver operating characteristics curve. BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital.\n\nFigure S2\nS2Figure S2\n\nFigure S10 .Figure S11 .\nS10S11Discrimination of HCM with ECG model in various subgroupsROC plots for HCM discrimination using ECG model trained with a federated manner for various subgroups in the external institution (BWH): limiting the HCM cases to apical HCM or non-apical HCM (Top), limiting HCM cases to those with and without MRI confirmation (Middle), limiting the ECGs to those obtained in outpatient settings and limiting the controls to only those without LVH confirmed with echocardiograms. BWH: Brigham and Women's Hospital. LVH: Left ventricular hypertrophy Data selection procedure for BWH ECG cohort with only non-LVH controls.\n\nFigure S16 .Figure S17 .\nS16S17Discrimination of HCM by ECG model trained with federated learning using dataset subsampled to match the number of samples from Keio university ROC plots for HCM discrimination of ECG models trained in a federated manner on a held-out internal data for each institution and on an external dataset. The 95% CI of true positive fraction for a given false positive fraction are shown as blue ribbon. N is the numbers of studies. BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital, ROC: receiver operating characteristics, AUC: area under the curve. ECG: electrocardiogram. Data selection procedure for the BWH echocardiogram cohort.\n\nFigure S22 .\nS22Data selection procedure for BWH echocardiogram cohort evaluating discrimination of HCM with HTN.History of HTN was defined as median systolic blood pressure \u2265140 before the echocardiogram was recorded. BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, LVH: Left ventricular hypertrophy, LBBB: left bundle branch block. HTN: hypertension.\n\nFigure S28 .Figure S29 .Figure S30 .\nS28S29S30Discrimination of HCM for individual institution model trained at different case control matching ratio. Ratio is shown as numbers of control per cases. AUROC: area under the receiver operating characteristics curve. MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital, ROC: receiver operating characteristics, AUC: area under the curve. ECG: electrocardiogram. Architecture of ECG model Architecture of echocardiogram model\n\nTable S1 .\nS1Baseline characteristics of the ECG cohorts (study level).BWH \nMGH \nUCSF \nKeio \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \nNumber of studies \n3,932 \n19,660 \n3,802 \n19,010 \n1,461 \n7,305 \n3,201 \n16,005 \nAge, years \n0 \n56.8 \u00b1 13.7 \n56.8 \u00b1 13.7 \n0 \n57.2 \u00b1 15.2 \n57.3 \u00b1 15.2 \n0 \n58.8 \u00b1 14.9 \n58.8 \u00b1 14.9 \n0 \n64.3 \u00b1 13.2 \n64.3 \u00b1 13.2 \nFemale \n0 \n1,946 (49.5) \n9,730 (49.5) \n0 \n1,304 (34.3) \n6,520 (34.3) \n0 \n617 (42.2) \n3,085 (42.2) \n0 \n1,062 (33.2) \n5,310 (33.2) \nRace \n0 \n0 \n0 \n0 \nWhite \n2,907 (73.9) \n11,658 (59.3) \n2,782 (73.2) \n15,098 (79.4) \n624 (42.7) \n3,248 (44.5) \n0 (0.0) \n0 (0.0) \nBlack \n384 (9.8) \n1,647 (8.4) \n418 (11.0) \n970 (5.1) \n146 (10.0) \n614 (8.4) \n0 (0.0) \n0 (0.0) \nAsian \n101 (2.6) \n275 (1.4) \n178 (4.7) \n498 (2.6) \n54 (3.7) \n467 (6.4) \n3,201 (100.0) 16,005 (100.0) \nHispanic \n85 (2.2) \n587 (3.0) \n16 (0.4) \n157 (0.8) \n38 (2.6) \n391 (5.4) \n0 (0.0) \n0 (0.0) \nOthers \n99 (2.5) \n750 (3.8) \n158 (4.2) \n1,020 (5.4) \n267 (18.3) \n762 (10.4) \n0 (0.0) \n0 (0.0) \nUnknown \n356 (9.1) \n4,743 (24.1) \n250 (6.6) \n1,267 (6.7) \n332 (22.7) \n1823 (25.0) \n0 (0.0) \n0 (0.0) \nHR, bpm \n0 \n69.6 \u00b1 18.5 \n81.0 \u00b1 21.4 \n0 \n70.2 \u00b1 17.4 \n77.6 \u00b1 20.5 \n0 \n71.0 \u00b1 17.6 \n79.3 \u00b1 21.5 \n0 \n64.9 \u00b1 14.0 \n70.3 \u00b1 14.6 \nPR interval, ms \n0 \n174.3 \u00b1 41.8 \n158.5 \u00b1 45.3 \n0 \n170.6 \u00b1 47.1 \n160.8 \u00b1 52.5 \n0 \n178.6 \u00b1 36.0 \n162.2 \u00b1 31.3 \n0 \n178.6 \u00b1 32.8 \n170.2 \u00b1 30.7 \nQRS duration, ms \n0 \n100.5 \u00b1 20.9 \n91.7 \u00b1 17.8 \n0 \n101.1 \u00b1 21.6 \n95.1 \u00b1 21.2 \n0 \n106.3 \u00b1 22.6 \n93.5 \u00b1 18.1 \n0 \n108.6 \u00b1 20.6 \n95.9 \u00b1 16.7 \nQT corrected, ms \n0 \n460.2 \u00b1 37.9 \n441.4 \u00b1 64.3 \n0 \n444.3 \u00b1 38.0 \n437.2 \u00b1 38.7 \n0 \n462.9 \u00b1 36.7 \n444.6 \u00b1 37.6 \n0 \n440.0 \u00b1 31.2 \n417.4 \u00b1 24.3 \nV5 R amplitude, !V 0 \n1,813 \u00b1 1,138 1,358 \u00b1 728 \n0 \n1,878 \u00b1 1,217 1,364 \u00b1 727 \n0 \n1,810 \u00b1 1,203 1,490 \u00b1 767 \n0 \n2,382 \u00b1 1,334 1,817 \u00b1 744 \nV6 R amplitude, !V 0 \n1,639 \u00b1 941 \n1203 \u00b1 609 \n0 \n1,644 \u00b1 1,005 1,202 \u00b1 609 \n0 \n1,592 \u00b1 1,049 1,278 \u00b1 643 \n0 \n1,960 \u00b1 1,073 1,446 \u00b1 608 \nV1 S amplitude, !V 0 \n1,612 \u00b1 1,011 957 \u00b1 563 \n0 \n1,434 \u00b1 847 \n925 \u00b1 541 \n0 \n1,469 \u00b1 1,028 945 \u00b1 568 \n0 \n1,318 \u00b1 786 \n884 \u00b1 500 \nV2 S amplitude, !V 0 \n1,775 \u00b1 1,104 1,201 \u00b1 737 \n0 \n1,585 \u00b1 1,029 1167 \u00b1 739 \n0 \n1,720 \u00b1 1,277 1,326 \u00b1 802 \n0 \n1856 \u00b1 1088 \n1316 \u00b1 674 \nLVOT PG, mmHg \n331 \n54.0 \u00b1 47.5 \nNA \n459 \n33.1 \u00b1 41.9 \nNA \nNA \nNA \n2,843 \n87.0 \u00b1 31.7 \nNA \nLVOT PG group \n331 \n459 \n2,843 \n\u226425 \n1,389 (38.6) \nNA \n2,012 (60.2) \nNA \nNA \nNA \n4 (1.1) \nNA \n25-50 \n400 (11.1) \nNA \n399 (11.9) \nNA \nNA \nNA \n27 (7.5) \nNA \n50-75 \n522 (14.5) \nNA \n297 (8.9) \nNA \nNA \nNA \n144 (40.2) \nNA \n75-100 \n477 (13.2) \nNA \n324 (9.7) \nNA \nNA \nNA \n81 (22.6) \nNA \n>100 \n813 (22.6) \nNA \n311 (9.3) \nNA \nNA \nNA \n102 (28.5) \nNA \nApical \n0 \n713 (18.1) \nNA \n0 \n1,279 (33.6) \nNA \nNA \nNA \n0 \n804 (25.1) \nNA \nGenetic mutation # \n2,139 \n1,061 (59.2) \nNA \n2,797 \n498 (49.6) \nNA \nNA \nNA \n2,253 \n84 (8.9) \nNA \nOutpatient \n0 \n3,083 (78.4) \n17,546 (89.2) \n0 \n3,035 (79.8) \n15,948 (83.9) \nNA \nNA \nNA \nNA \nConfirmed by MRI \n0 \n2,269 (57.7) \nNA \n0 \n2,048 (53.9) \nNA \nNA \nNA \n0 \n1,397 (43.6) \nNA \nSampling rate \n0 \n0 \n240 Hz \n57 (1.4) \n1,985 (10.1) \n67 (1.8) \n2,278 (12.\n\nTable S2 .\nS2Baseline characteristics of the ECG cohorts (patient level).BWH \nMGH \nUCSF \nKeio \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \nNumber of patients \n447 \n17,671 \n324 \n17,525 \n196 \n6,684 \n141 \n13,141 \nFemale \n0 \n179 (40.0) \n8,792 (49.8) \n0 \n117 (36.1) \n6,151 (35.1) \n0 \n80 (40.8) \n2,816 (42.1) \n0 \n59 (41.8) \n4,579 (34.8) \nRace \n0 \n0 \n0 \n0 \nWhite \n349 (78.1) \n10,691 (60.5) \n254 (78.4) \n13,928 (79.5) \n80 (40.8) \n2,985 (44.7) \n0 (0.0) \n0 (0.0) \nBlack \n26 (5.8) \n1,357 (7.7) \n26 (8.0) \n858 (4.9) \n10 (5.1) \n522 (7.8) \n0 (0.0) \n0 (0.0) \nAsian \n15 (3.4) \n249 (1.4) \n15 (4.6) \n465 (2.7) \n7 (3.6) \n433 (6.5) \n59 (100.0) \n4,579 (100.0) \nHispanic \n5 (1.1) \n497 (2.8) \n1 (0.3) \n144 (0.8) \n4 (2.0) \n361 (5.4) \n0 (0.0) \n0 (0.0) \nOthers \n13 (2.9) \n682 (3.9) \n13 (4.0) \n941 (5.4) \n23 (11.7) \n693 (10.4) \n0 (0.0) \n0 (0.0) \nUnknown \n39 (8.7) \n4195 (23.7) \n15 (4.6) \n1,189 (6.8) \n72 (36.7) \n1,690 (25.3) \n0 (0.0) \n0 (0.0) \nMax LVOT PG, \nmmHg \n\n59 \n46.9 \u00b1 50.3 \nNA \n37 \n38.7 \u00b1 46.4 \nNA \nNA \nNA \n142 \n98.0 \u00b1 44.0 \nNA \n\nMax LVOT PG \ngroup \n\n59 \n37 \n142 \n\n\u226425 \n180 (46.4) \nNA \n157 (54.7) \nNA \nNA \nNA \n1 (3.0) \nNA \n25-50 \n49 (12.6) \nNA \n32 (11.1) \nNA \nNA \nNA \n3 (9.1) \nNA \n50-75 \n45 (11.6) \nNA \n26 (9.1) \nNA \nNA \nNA \n9 (27.3) \nNA \n75-100 \n46 (11.9) \nNA \n30 (10.5) \nNA \nNA \nNA \n5 (15.2) \nNA \n>100 \n68 (17.5) \nNA \n42 (14.6) \nNA \nNA \nNA \n15 (45.5) \nNA \nApical \n0 \n96 (21.5) \nNA \n0 \n96 (29.6) \nNA \nNA \nNA \n0 \n39 (27.7) \nNA \nGenetic mutation # \n256 \n92 (48.2) \nNA \n235 \n44 (49.4) \nNA \nNA \nNA \n113 \n4 (14.3) \nNA \nHistory of VT/VF \n0 \n63 (14.1) \nNA \n0 \n59 (18.2) \nNA \nNA \nNA \n0 \n19 (13.5) \nNA \nFamily history \n37 \n166 (40.5) \nNA \n50 \n76 (27.7) \nNA \nNA \nNA \n0 \n13 (9.2) \nNA \nConfirmed by MRI \n0 \n275 (61.5) \nNA \n0 \n180 (55.6) \nNA \nNA \nNA \n0 \n61 (43.3) \nNA \n\n#: Only mutants classified as pathologic or likely pathologic are considered positive. The numbers represent the number of patients. NA: not \navailable, BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, \nKeio: Keio University Hospital, PG: pressure gradient, VT: ventricular tachycardia, VF: ventricular fibrillation, MRI: magnetic resonance \nimaging. \n\n\nTable S3 .\nS3Baseline characteristics of the ECG cohort with HTN.Missing \n\nStudy-level \nMissing \nPatient-level \nNumbers \n2,602 \n573 \nAge, years \n0 \n67.5 \u00b1 16.1 \nNA \nFemale \n0 \n1,127 (43.3) \n0 \n242 (42.2) \nRace \n0 \n0 \nWhite \n1,712 (65.8) \n439 (76.6) \nBlack \n569 (21.9) \n70 (12.2) \nAsian \n55 (2.1) \n13 (2.3) \nHispanic \n56 (2.2) \n11 (1.9) \nOthers \n160 (6.1) \n21 (3.7) \nUnknown \n50 (1.9) \n19 (3.3) \nMedian sBP before ECG, mmHg \n0 \n149.4 \u00b1 7.8 \nNA \nMax sBP before ECG, mmHg \n0 \n206.6 \u00b1 24.3 \nNA \nMedian dBP before ECG, mmHg \n0 \n75.1 \u00b1 10.4 \nNA \nMax dBP before ECG, mmHg \n0 \n110.6 \u00b1 21.1 \nNA \nHR, bpm \n0 \n74.5 \u00b1 16.7 \nNA \nPR interval, ms \n0 \n174.6 \u00b1 40.0 \nNA \nQRS duration, ms \n0 \n103.2 \u00b1 23.8 \nNA \nQT corrected, ms \n0 \n459.6 \u00b1 36.4 \nNA \nV5 R amplitude, !V \n0 \n1,463 \u00b1 856 \nNA \nV6 R amplitude, !V \n0 \n1,329 \u00b1 743 \nNA \nV1 S amplitude, !V \n0 \n1,208 \u00b1 869 \nNA \nV2 S amplitude, !V \n0 \n1,472 \u00b1 1,027 \nNA \nOutpatient \n0 \n1,361 (52.3) \nNA \nSampling rate \n0 \n240 Hz \n6 (0.2) \nNA \n250 Hz \n346 (13.3) \nNA \n500 Hz \n2,250 (86.4) \nNA \nVendor \n0 \nGE \n2,602 (100.0) \nNA \nNihon Kohden \n0 (0.0) \nNA \n\nHTN: hypertension, sBP: systolic blood pressure, dBP: diastolic blood pressure, NA: not applicable, HR: heart rate \n\n\nTable S4 .\nS4Baseline characteristics of the ECG cohort with AS.Missing \n\nStudy-level \nMissing \nPatient-level \nNumbers \n2,067 \n299 \nAge, years \n0 \n74.3 \u00b1 12.0 \nNA \nFemale \n0 \n914 (44.2) \n0 \n149 (49.8) \nRace \n0 \n0 \nWhite \n1,776 (85.9) \n264 (88.3) \nBlack \n90 (4.4) \n12 (4.0) \nAsian \n25 (1.2) \n4 (1.3) \nHispanic \n76 (3.7) \n7 (2.3) \nOthers \n51 (2.5) \n4 (1.3) \nUnknown \n49 (2.4) \n8 (2.7) \nAortic valve area, cm 2 \n0 \n0.7 \u00b1 0.2 \nNA \nAV Peak velocity, cm/sec \n0 \n367.6 \u00b1 154.1 \nNA \nAV Mean PG, mmHg \n0 \n36.2 \u00b1 16.8 \nNA \nHR, bpm \n0 \n80.2 \u00b1 21.5 \nNA \nPR interval, ms \n0 \n182.0 \u00b1 42.3 \nNA \nQRS duration, ms \n0 \n110.1 \u00b1 26.8 \nNA \nQT corrected, ms \n0 \n465.7 \u00b1 41.2 \nNA \nV5 R amplitude, !V \n0 \n1,219 \u00b1 783 \nNA \nV6 R amplitude, !V \n0 \n1,149 \u00b1 671 \nNA \nV1 S amplitude, !V \n0 \n1,090 \u00b1 817 \nNA \nV2 S amplitude, !V \n0 \n1,489 \u00b1 1,117 \nNA \nOutpatient \n0 \n1,523 (73.7) \nNA \nSampling rate \n0 \n240 Hz \n1 (0.0) \nNA \n250 Hz \n198 (9.6) \nNA \n500 Hz \n1868 (90.4) \nNA \nVendor \n0 \nGE \n2,067 (100.0) \nNA \nNihon Kohden \n0 (0.0) \nNA \n\nAV: aortic valve, AS: aortic valve stenosis, PG: pressure gradient, NA: not applicable, HR: heart rate \n\n\nTable S5 .\nS5Baseline characteristics of the ECG cohort with CA.Table S6. Discrimination of HCM by the baseline models using ECG readings and patient characteristics as tabular data. Results are shown as AUCROC (95% confidence interval). BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital, AUROC: area under the receiver operating characteristics curve. ECG: electrocardiogram, LR: Logistic regressionTable S7. Baseline characteristics of the echocardiogram cohorts (study-level).Missing \n\nStudy-level \nMissing \nPatient-level \nNumbers \n3,233 \n364 \nAge, years \n0 \n71.5 \u00b1 9.8 \nNA \nFemale \n0 \n862 (26.7) \n0 \n69 (19.0) \nRace \n0 \n0 \nWhite \n2,495 (77.2) \n302 (83.0) \nBlack \n499 (15.4) \n32 (8.8) \nAsian \n8 (0.2) \n3 (0.8) \nHispanic \n21 (0.6) \n1 (0.3) \nOthers \n20 (0.6) \n3 (0.8) \nUnknown \n190 (5.9) \n19 (5.2) \nType of amyloid \n0 \nATTR \n1,877 (58.1) \n234 (64.3) \nAL \n1,306 (40.4) \n127 (34.9) \nAA \n32 (1.0) \n1 (0.3) \nUnclear \n18 (0.6) \n2 (0.5) \nHR, bpm \n0 \n78.9 \u00b1 17.1 \nNA \nPR interval, ms \n0 \n209.7 \u00b1 50.3 \nNA \nQRS duration, ms \n0 \n111.9 \u00b1 27.7 \nNA \nQT corrected, ms \n0 \n485.7 \u00b1 45.4 \nNA \nV5 R amplitude, !V \n0 \n739.6 \u00b1 564.0 \nNA \nV6 R amplitude, !V \n0 \n653.2 \u00b1 498.0 \nNA \nV1 S amplitude, !V \n0 \n560.4 \u00b1 474.0 \nNA \nV2 S amplitude, !V \n0 \n1,135.1 \u00b1 843.3 \nNA \nOutpatient \n0 \n2,166 (67.0) \nNA \nLVH \n1,765 \n1,256 (85.0) \nNA \nSampling rate \n0 \n240 Hz \n2 (0.1) \nNA \n250 Hz \n295 (9.1) \nNA \n500 Hz \n2,936 (90.8) \nNA \nVendor \n0 \nGE \n3,233 (100.0) \nNA \nNihon Kohden \n0 (0.0) \nNA \n\nCA: cardiac amyloidosis, ATTR: amyloid transthyretin, AL: amyloid light chain, AA: amyloid A, LVH: left ventricular hypertrophy, NA: not \napplicable, HR: heart rate \nInstitution \nLR without \ninteractions \n\nLR with 1 st order \ninteractions \n\nLR with 2 nd order \ninteractions \n\nRandom forest \n\nBWH \n0.82 (0.81-0.83) \n0.82 (0.82-0.83) 0.82 (0.81-0.83) 0.81 (0.81-0.82) \nMGH \n0.77 (0.75-0.79) \n0.78 (0.76-0.80) 0.76 (0.74-0.78) 0.79 (0.77-0.81) \nUCSF \n0.85 (0.82-0.87) \n0.85 (0.83-0.87) 0.83 (0.81-0.86) 0.83 (0.81-0.85) \nKEIO \n0.79 (0.77-0.81) \n0.78 (0.75-0.80) 0.82 (0.81-0.83) 0.77 (0.75-0.80) \nBWH \nMGH \nUCSF \nKeio \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \nNumber of studies \n760 \n2,280 \n514 \n1,542 \n296 \n888 \n528 \n1,584 \nAge, years \n0 \n52.7 \u00b1 14.3 \n52.9 \u00b1 14.2 \n0 \n60.5 \u00b1 14.9 \n60.6 \u00b1 14.9 \n0 \n59.2 \u00b1 15.2 \n59.1 \u00b1 15.1 \n0 \n70.0 \u00b1 13.7 \n70.0 \u00b1 13.6 \nFemale \n0 \n313 (41.2) \n939 (41.2) \n0 \n178 (34.6) \n534 (34.6) \n0 \n136 (45.9) \n408 (45.9) \n0 \n202 (38.3) \n606 (38.3) \nRace \n0 \n0 \n0 \n0 \nWhite \n616 (81.1) \n1686 (73.9) \n365 (71.0) \n1121 (72.7) \n154 (52.0) \n353 (39.8) \n0 (0.0) \n0 (0.0) \nBlack \n45 (5.9) \n243 (10.7) \n31 (6.0) \n77 (5.0) \n22 (7.4) \n44 (5.0) \n0 (0.0) \n0 (0.0) \nAsian \n30 (3.9) \n59 (2.6) \n18 (3.5) \n49 (3.2) \n12 (4.1) \n71 (8.0) \n528 (100.0) \n1,584 (100.0) \nHispanic \n3 (0.4) \n73 (3.2) \n0 (0.0) \n12 (0.8) \n6 (2.0) \n25 (2.8) \n0 (0.0) \n0 (0.0) \nOthers \n18 (2.4) \n89 (3.9) \n28 (5.4) \n75 (4.9) \n30 (10.1) \n130 (14.6) \n0 (0.0) \n0 (0.0) \nUnknown \n48 (6.3) \n130 (5.7) \n72 (14.0) \n208 (13.5) \n72 (24.3) \n265 (29.8) \n0 (0.0) \n0 (0.0) \nHR, bpm \n5 \n63.5 \u00b1 12.3 \n74.5 \u00b1 17.0 \n0 \n65.0 \u00b1 14.8 \n72.4 \u00b1 16.7 \n0 \n65.7 \u00b1 17.1 \n73.5 \u00b1 17.3 \n0 \n63.0 \u00b1 13.3 \n68.4 \u00b1 15.1 \nLVDd, mm \n1,247 \n42.5 \u00b1 7.3 \n47.0 \u00b1 8.9 \n753 \n43.5 \u00b1 6.9 \n47.1 \u00b1 7.6 \n383 \n42.2 \u00b1 7.1 \n46.1 \u00b1 7.4 \n267 \n44.7 \u00b1 6.4 \n45.0 \u00b1 6.6 \nLVEF, % \n1,188 \n68.0 \u00b1 7.0 \n57.9 \u00b1 11.6 \n753 \n70.7 \u00b1 9.7 \n61.8 \u00b1 13.5 \n187 \n67.2 \u00b1 8.9 \n61.6 \u00b1 11.1 \n265 \n68.2 \u00b1 12.2 \n65.2 \u00b1 11.5 \nPWT, mm \n1,250 \n12.4 \u00b1 8.0 \n10.3 \u00b1 5.3 \n778 \n12.2 \u00b1 4.6 \n10.5 \u00b1 2.2 \n383 \n12.0 \u00b1 3.2 \n10.1 \u00b1 2.3 \n267 \n9.9 \u00b1 1.5 \n9.3 \u00b1 1.4 \nIVST, mm \n1,250 \n18.3 \u00b1 15.1 \n12.1 \u00b1 12.4 \n778 \n16.1 \u00b1 3.8 \n11.4 \u00b1 2.6 \n383 \n15.8 \u00b1 4.6 \n10.5 \u00b1 2.7 \n267 \n12.5 \u00b1 2.5 \n9.6 \u00b1 1.7 \nLVOT PG, mmHg \n647 \n68.0 \u00b1 45.1 \nNA \n421 \n72.4 \u00b1 41.4 \nNA \nNA \nNA \n464 \n83.5 \u00b1 40.7 \nNA \nLVOT PG group \n647 \n421 \n464 \n\u226425 \n23 (20.4) \nNA \n17 (18.3) \nNA \nNA \nNA \n7 (10.9) \nNA \n25-50 \n22 (19.5) \nNA \n16 (17.2) \nNA \nNA \nNA \n5 (7.8) \nNA \n50-75 \n22 (19.5) \nNA \n16 (17.2) \nNA \nNA \nNA \n18 (28.1) \nNA \n75-100 \n18 (15.9) \nNA \n17 (18.3) \nNA \nNA \nNA \n15 (23.4) \nNA \n>100 \n28 (24.8) \nNA \n27 (29.0) \nNA \nNA \nNA \n19 (29.7) \nNA \nApical \n0 \n129 (17.0) \nNA \n0 \n141 (27.4) \nNA \nNA \nNA \n0 \n164 (31.1) \nNA \nGenetic mutation # \n383 \n201 (53.3) \nNA \n404 \n57 (51.8) \nNA \nNA \nNA \n428 \n9 (9.0) \nNA \nOutpatient \n0 \n295 (38.8) \n1323 (58.0) \n0 \n271 (52.7) \n923 (59.9) \nNA \nNA \nNA \nNA \nConfirmed by MRI \n0 \n530 (69.7) \nNA \n0 \n261 (50.8) \nNA \nNA \nNA \n0 \n185 (35.0) \nNA \nLVH \n1,413 \n306 (65.4) \n311 (26.8) \n854 \n173 (62.9) \n270 (29.1) \n407 \n88 (53.0) \n109 (17.8) \n857 \n154 (48.9) \n218 (23.2) \nVendor \n0 \n0 \n0 \n0 \nGE \n161 (21.2) \n505 (22.1) \n29 (5.6) \n65 (4.2) \n39 (13.2) \n102 (11.5) \n247 (46.8) \n698 (44.1) \nPhilipps \n589 (77.5) \n1,765 (77.4) \n483 (94.0) \n1473 (95.5) \n257 (86.8) \n786 (88.5) \n176 (33.3) \n557 (35.2) \nSIEMENS \n10 (1.3) \n\n\n\n#: Only mutants classified as pathologic or likely pathologic are considered positive. The numbers represent the number of studies. Note that IVST measurements in Keio University Hospital excluded the right ventricle. LVDd: left ventricular end-diastolic diameter, LVEF: left ventricular ejection fraction, PWT: posterior wall thickness, IVST: interventricular septum thickness, LVH: left ventricular hypertrophy, NA: not available, HR: heart rate, BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital, PG: pressure gradient, VT: ventricular tachycardia, VF: ventricular fibrillation, MRI: magnetic resonance imaging.) \n105 (19.9) \n329 (20.8) \n\n\n\nTable S8 .\nS8Baseline characteristics of the echocardiogram cohorts (patient level).BWH \nMGH \nUCSF \nKeio \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \n\nMissing \n\nCase \nControl \nNumber of patients \n327 \n2,128 \n242 \n1,458 \n167 \n864 \n172 \n1,467 \nFemale \n0 \n124 (37.9) \n902 (42.4) \n0 \n84 (34.7) \n511 (35.0) \n0 \n75 (44.9) \n389 (45.0) \n0 \n71 (41.3) \n559 (38.1) \nRace \n0 \n0 \n0 \n0 \nWhite \n259 (79.2) \n1,573 (73.9) \n169 (69.8) \n1,064 (73.0) \n73 (43.7) \n336 (38.9) \n0 (0.0) \n0 (0.0) \nBlack \n20 (6.1) \n217 (10.2) \n17 (7.0) \n66 (4.5) \n10 (6.0) \n44 (5.1) \n0 (0.0) \n0 (0.0) \nAsian \n13 (4.0) \n57 (2.7) \n9 (3.7) \n43 (2.9) \n8 (4.8) \n68 (7.9) \n173 (100.0) \n1,467 (100.0) \nHispanic \n3 (0.9) \n68 (3.2) \n0 (0.0) \n12 (0.8) \n4 (2.4) \n25 (2.9) \n0 (0.0) \n0 (0.0) \nOthers \n10 (3.1) \n84 (3.9) \n12 (5.0) \n66 (4.5) \n18 (10.8) \n129 (14.9) \n0 (0.0) \n0 (0.0) \nUnknown \n22 (6.7) \n129 (6.1) \n35 (14.5) \n207 (14.2) \n54 (32.3) \n262 (30.3) \n0 (0.0) \n0 (0.0) \nMax LVOT PG, \nmmHg \n\n35 \n49.6 \u00b1 51.1 \nNA \n29 \n37.9 \u00b1 44.9 \nNA \nNA \nNA \n142 \n89.3 \u00b1 43.5 \nNA \n\nMax LVOT PG \ngroup \n\n35 \n29 \n142 \n\n\u226425 \n128 (43.8) \nNA \n116 (54.5) \nNA \nNA \nNA \n2 (6.7) \nNA \n25-50 \n39 (13.4) \nNA \n26 (12.2) \nNA \nNA \nNA \n4 (13.3) \nNA \n50-75 \n34 (11.6) \nNA \n18 (8.5) \nNA \nNA \nNA \n8 (26.7) \nNA \n75-100 \n35 (12.0) \nNA \n24 (11.3) \nNA \nNA \nNA \n5 (16.7) \nNA \n>100 \n56 (19.2) \nNA \n29 (13.6) \nNA \nNA \nNA \n11 (36.7) \nNA \nApical \n0 \n64 (19.6) \nNA \n0 \n67 (27.7) \nNA \nNA \nNA \n0 \n48 (27.9) \nNA \nGenetic mutation # \n179 \n74 (50.0) \nNA \n194 \n24 (50.0) \nNA \nNA \nNA \n143 \n4 (13.8) \nNA \nConfirmed by MRI \n0 \n218 (66.7) \nNA \n0 \n131 (54.1) \nNA \nNA \nNA \n0 \n61 (35.5) \nNA \nHistory of VT/VF \n0 \n33 (10.1) \nNA \n0 \n45 (18.8) \nNA \nNA \nNA \n0 \n21 (12.2) \nNA \nFamily history \n31 \n118 (39.9) \nNA \n34 \n43 (20.7) \nNA \nNA \nNA \n1 \n13 (7.6) \nNA \n\n#: Only mutants classified as pathologic or likely pathologic are considered positive. The numbers represent the number of patients. NA: not \navailable, BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, \nKeio: Keio University Hospital, PG: pressure gradient, VT: ventricular tachycardia, VF: ventricular fibrillation, MRI: magnetic resonance \nimaging. \n\n\nTable S9 .\nS9Baseline characteristics of the echocardiogram cohort with HTN. LVEF: left ventricular ejection fraction, PWT: posterior wall thickness, IVST: interventricular septum thickness, HR: heart rateMissing \n\nStudy-level \nMissing \nPatient-level \nNumbers \n833 \n731 \nAge, years \n0 \n70.6 \u00b1 12.7 \nNA \nFemale \n0 \n408 (49.0) \n0 \n370 (50.6) \nRace \n0 \n0 \nWhite \n619 (74.3) \n535 (73.2) \nBlack \n119 (14.3) \n105 (14.4) \nAsian \n16 (1.9) \n16 (2.2) \nHispanic \n19 (2.3) \n18 (2.5) \nOthers \n27 (3.2) \n26 (3.6) \nUnknown \n33 (4.0) \n31 (4.2) \nHR, bpm \n0 \n68.2 \u00b1 14.3 \nNA \nLVDd, mm \n1 \n47.1 \u00b1 7.7 \nNA \nLVEF, % \n28 \n58.1 \u00b1 10.8 \nNA \nPWT, mm \n3 \n12.6 \u00b1 3.0 \nNA \nIVST, mm \n3 \n16.1 \u00b1 16.6 \nNA \nMedian sBP before study, mmHg \n0 \n148.5 \u00b1 10.7 \nNA \nMax sBP before study, mmHg \n0 \n192.8 \u00b1 25.0 \nNA \nMedian dBP before study, mmHg \n0 \n76.5 \u00b1 9.6 \nNA \nMax dBP before study, mmHg \n0 \n102.9 \u00b1 17.9 \nNA \nOutpatient \n0 \n235 (28.2) \nNA \nVendor \n0 \nGE \n262 (31.5) \nNA \nPhilipps \n571 (68.5) \nNA \nSIEMENS \n0 (0.0) \nNA \nSonoSite \n0 (0.0) \nNA \nATL \n0 (0.0) \nNA \nMINDRAY \n0 (0.0) \nNA \n\nHTN: hypertension, sBP: systolic blood pressure, dBP: diastolic blood pressure, NA: not applicable, LVDd: left ventricular end-diastolic \ndiameter, \n\nTable S10 .\nS10Baseline characteristics of the echocardiogram cohort with AS.Missing \n\nStudy-level \nMissing \nPatient-level \nNumbers \n346 \n284 \nAge, years \n0 \n75.7 \u00b1 12.3 \nNA \nFemale \n0 \n175 (50.6) \n0 \n137 (48.2) \nRace \n0 \n0 \nWhite \n302 (87.3) \n242 (85.2) \nBlack \n9 (2.6) \n9 (3.2) \nAsian \n3 (0.9) \n3 (1.1) \nHispanic \n6 (1.7) \n6 (2.1) \nOthers \n6 (1.7) \n6 (2.1) \nUnknown \n20 (5.8) \n18 (6.3) \nHR, bpm \n0 \n71.6 \u00b1 16.9 \nNA \nLVDd, mm \n0 \n46.6 \u00b1 8.0 \nNA \nLVEF, % \n9 \n55.9 \u00b1 14.2 \nNA \nPWT, mm \n0 \n12.7 \u00b1 3.0 \nNA \nIVST, mm \n0 \n15.0 \u00b1 12.0 \nNA \nAortic valve area, cm 2 \n0 \n0.7 \u00b1 0.2 \nNA \nAV Peak velocity, cm/sec \n4 \n381.5 \u00b1 113.0 \nNA \nAV Mean PG, mmHg \n4 \n35.9 \u00b1 15.8 \nNA \nOutpatient \n0 \n105 (30.3) \nNA \nVendor \n0 \nGE \n68 (19.7) \nNA \nPhilipps \n278 \n\nTable S11 .\nS11Baseline characteristics of the echocardiogram cohort with CA. CA: cardiac amyloidosis, ATTR: amyloid transthyretin, AL: amyloid light chain, AA: amyloid A, LVH: left ventricular hypertrophy, NA: not applicable, LVDd: left ventricular end-diastolic diameter, LVEF: left ventricular ejection fraction, PWT: posterior wall thickness, IVST: interventricular septum thickness, HR: heart rateTable S12. Discrimination of HCM by the baseline models using echocardiogram readings and patient characteristics as tabular data.Missing \n\nStudy-level \nMissing \nPatient-level \nNumbers \n816 \n313 \nAge, years \n0 \n72.4 \u00b1 9.2 \nNA \nFemale \n0 \n168 (20.6) \n0 \n57 (18.2) \nRace \n0 \n0 \nWhite \n684 (83.8) \n256 (81.8) \nBlack \n69 (8.5) \n32 (10.2) \nAsian \n13 (1.6) \n4 (1.3) \nHispanic \n0 (0.0) \n0 (0.0) \nOthers \n8 (1.0) \n3 (1.0) \nUnknown \n42 (5.1) \n18 (5.8) \nHR, bpm \n1 \n74.7 \u00b1 19.8 \nNA \nLVDd, mm \n147 \n41.2 \u00b1 6.6 \nNA \nLVEF, % \n148 \n49.1 \u00b1 13.5 \nNA \nPWT, mm \n146 \n16.8 \u00b1 3.6 \nNA \nIVST, mm \n146 \n17.9 \u00b1 9.6 \nNA \nType of amyloid \n0 \n0 \nATTR \n535 (65.6) \n206 (65.8) \nAL \n278 (34.1) \n106 (33.9) \nAA \n3 (0.4) \n1 (0.3) \nOutpatient \n191 (23.4) \nNA \nLVH \n536 (87.2) \nNA \nVendor \n0 \nGE \n717 (87.9) \nNA \nPhilipps \n98 (12.0) \nNA \nSIEMENS \n1 (0.1) \nNA \nSonoSite \n0 (0.0) \nNA \nATL \n0 (0.0) \nNA \nMINDRAY \n0 (0.0) \nNA \n\nInstitution \nLR without \ninteractions \n\nLR with 1 st order \ninteractions \n\nLR with 2 nd order \ninteractions \n\nRandom forest \n\n\n\nTable S13 .\nS13Baseline characteristics of the HCM surveillance cohort.BWH surveillance cohort \nMissing \nCase \nControl \nNumber of patients, n \n59 \n11,764 \nAge, years \u00b1 SD \n0 \n57.4 \u00b1 15.4 \n61.9 \u00b1 16.1 \nFemale, n (%) \n0 \n26 (44.1) \n5,628 (47.8) \nRace, n (%) \n0 \nWhite \n50 (84.7) \n8,921 (75.8) \nBlack \n2 (3.4) \n993 (8.4) \nAsian \n2 (3.4) \n264 (2.2) \nHispanic \n1 (1.7) \n312 (2.7) \nOthers \n1 (1.7) \n337 (2.9) \nUnknown \n3 (5.1) \n937 (8.0) \nHR, bpm \u00b1 SD \n65.9 \u00b1 14.0 \n77.6 \u00b1 19.9 \nLVOT PG, mmHg \n1 \n55.3 \u00b1 50.8 \nNA \nLVOT PG group \n1 \n\u226425 \n22 (37.9) \nNA \n25-50 \n9 (15.5) \nNA \n50-75 \n7 (12.1) \nNA \n75-100 \n7 (12.1) \nNA \n>100 \n13 (22.4) \nNA \nApical \n0 \n11 (18.6) \nNA \nGenetic mutation # \n30 \n18 (62.1) \nNA \nOutpatient \n0 \n20 (33.9) \n7147 (60.8) \nConfirmed by MRI \n0 \n36 (61.0) \nNA \nHistory of VT/VF \n0 \n3 (5.1) \nNA \nFamily history \n3 \n18 (32.1) \nNA \nLVH \n5,141 \n26 (68.4) \n1976 (29.7) \n\nECG \nPR interval, ms \u00b1 SD \n172.2 \u00b1 30.8 \n166.1 \u00b1 34.9 \nQRS duration, ms \u00b1 SD \n97.8 \u00b1 13.9 \n94.6 \u00b1 19.8 \nQT corrected, ms \u00b1 SD \n447.5 \u00b1 25.8 \n445.1 \u00b1 35.9 \nV5 R amplitude, !V \u00b1 SD \n1,998 \u00b1 1,213 \n1,322 \u00b1 731 \nV6 R amplitude, !V \u00b1 SD \n1,831 \u00b1 983 \n1,176 \u00b1 617 \nV1 S amplitude, !V \u00b1 SD \n1,720 \u00b1 911 \n958 \u00b1 578 \nV2 S amplitude, !V \u00b1 SD \n1,998 \u00b1 1,119 \n1,206 \u00b1 764 \nSampling rate, n (%) \n240 Hz \n0 (0.0) \n68 (0.6) \n250 Hz \n6 (10.2) \n1856 (15.8) \n500 Hz \n53 (89.8) \n9840 (83.6) \nECG Vendor, n (%) \nGE \n59 (100.0) \n11,764 (100.0) \n\nEchocardiogram \nIVST, mm \u00b1 SD \n3,854 \n19.4 \u00b1 22.2 \n12.8 \u00b1 13.3 \nPWT, mm \u00b1 SD \n3,859 \n12.3 \u00b1 2.6 \n10.6 \u00b1 5.2 \nLVDd, mm \u00b1 SD \n3,840 \n41.5 \u00b1 6.6 \n45.1 \u00b1 8.3 \nEF, % \u00b1 SD \n3,750 \n69.5 \u00b1 5.9 \n58.1 \u00b1 11.4 \nEchocardiogram Vendor, n (%) \n0 \nGE \n11 (18.6) \n2,667 (22.7) \nPhillips \n47 (79.7) \n9,043 (76.9) \nSIEMENS \n1 (1.7) \n51 (0.\n\nTable S14 .\nS14Discrimination of HCM by experts for MRI confirmed and no-LVH casesCondition \nExperts \nBy \nSensitivity Specificity \nMRI confirmed cases \nRY \n0.31 \n0.99 \nSG \n0.47 \n0.99 \nJJ \n0.50 \n0.99 \nNo LVH cases \nRY \n0.25 \n0.99 \nSG \n0.33 \n0.99 \nJJ \n0.42 \n0.99 \nSupplemental Figures. \n\n\n\n\n). Thus, 12-lead ECGs are 12 recordings of voltages in time series which can be considered as a 2D matrix of induction vs time that has voltage recording in each cell. ECG: electrocardiogram.0 \n2 \n\u2026 \n188 \n\u2026 \nI \n0 \n0 \n\u2026 \n870 \n\u2026 \nII \n-30 \n-30 \n\u2026 \n760 \n\u2026 \nIII \n-30 \n-30 \n\u2026 \n-110 \u2026 \naVR \n15 \n15 \n\u2026 -815 \u2026 \n\u2026 \n\u2026 \n\u2026 \n\u2026 \n\u2026 \n\u2026 \n\nTime (ms) \n\nInduction \n\nInduction I \n\nI \n0 \n0 \n\u2026 870 \u2026 \n\n\n\nFigure S3. Data selection procedure for the BWH ECG cohort.UMAP projection of ECG data colored by various characteristics of the patient and ECG. The unit for the sampling rate is Hz. Heart rate is expressed as beats per minute. HCM: hypertrophy cardiomyopathy, BWH: Brigham and Women's Hospital, MGH: Massachusetts General Hospital, UCSF: University of California San Francisco, Keio: Keio University Hospital.). ECG: \nelectrocardiogram. \n\nI \n\nUMAP \n\nII \nIII \n\n\u2026 \n\n-30 -30 \u2026 -110 \u2026 \n-30 -30 \u2026 760 \u2026 \n0 \n0 \n\u2026 870 \u2026 \n\n-30 -30 \u2026 -110 \u2026 \n-30 -30 \u2026 760 \u2026 \n0 \n0 \n\u2026 870 \u2026 \n\nVector of 2500 \n\nVector of 30000 \n\nVector of 2500 \nVector of 2500 \n\n0 \n2 \n\u2026 \n188 \n\u2026 \nI \n0 \n0 \n\u2026 \n870 \n\u2026 \nII \n-30 \n-30 \n\u2026 \n760 \n\u2026 \nIII \n-30 \n-30 \n\u2026 \n-110 \u2026 \naVR \n15 \n15 \n\u2026 -815 \u2026 \n\u2026 \n\u2026 \n\u2026 \n\u2026 \n\u2026 \n\u2026 \n\nTime (ms) \n\nInduction \n\nMatrix of 12 x 2500 \n\n= \n\nSplit leads \nECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, \nLBBB: left bundle branch block \n\n481 HCM patients who had ECG \nwere identified (6,560 studies) \n\nMatched 1:5 based on age and sex to \npatients without HCM \n\n1,8118 patients, 23,592 ECG studies \n(Cases: 447 patients, 3,932 studies) \n\n447 patients, 3,932 ECG studies \n\nExcluded 2,628 \nineligible ECG \n(633 with Pacemaker, \n219 with LBBB, 1,776 \nwith non-standard ECG) \n\n649,857 patients with 4,583,747 \nECG studies who did not have \nany diagnosis of HCM \n\n471,012 patients, 2,682,998 \nECG studies \n\nExcluded 1,900,749 \nineligible ECG \n(203,436 with \nPacemaker, 149,902 \nwith LBBB, 1,547,412 \nwith non-standard ECG) \n\nIdentified 625 HCM patients \n23 had myectomy or \nablation before initial \nECG at BWH \n\n56 had pacemaker/ICD \nimplantation before initial \nECG at BWH \n\n63 did not have any ECG \navailable in the system \n\n2 did not have ECG at \nage \u226520 \nFigure S4. Data selection procedure for the MGH ECG cohort. \n\nECG: electrocardiogram, MGH: Massachusetts General Hospital, HCM: hypertrophic cardiomyopathy, \nLBBB: left bundle branch block \n\n330 HCM patients who had ECG \nwere identified (4,075 studies) \n\nMatched 1:5 based on age and sex to \npatients without HCM \n\n17,849 patients, 22,812 ECG studies \n(Cases: 324 patients, 3,802 studies) \n\n324 patients, 3,802 ECG studies \n\nExcluded 273 ineligible \nECG \n(131 with Pacemaker, \n80 with LBBB, 62 with \nnon-standard ECG) \n\n598,265 patients with 2,818,280 \nECG studies who did not have \nany diagnosis of HCM \n\n502,277 patients, 2,318,672 \nECG studies \n\nExcluded 499,608 \nineligible ECG \n(54,238 with Pacemaker, \n58,031 with LBBB, \n387,339 with non-\nstandard ECG) \n\nPatient level random split \n\nDerivation dataset: \n10,710 patients, 13,926 ECG studies \n(Cases: 204 patients, 2,530 studies) \n\nValidation dataset: \n3,570 patients, 4,379 ECG studies \n(Cases: 60 patients, 566 studies) \n\nTest dataset: \n3,569 patients, 4,507 ECG studies \n(Cases: 60 patients, 706 studies) \n\nIdentified 492 HCM patients \n30 had myectomy or \nablation before initial \nECG at MGH \n\n67 had pacemaker/ICD \nimplantation before initial \nECG at MGH \n\n65 did not have any ECG \navailable in the system \nFigure S5. Data selection procedure for the UCSF ECG cohort. \n\nECG: electrocardiogram, UCSF: University of California San Francisco, HCM: hypertrophic \ncardiomyopathy, LBBB: left bundle branch block \n\n207 HCM patients who had ECG \nwere identified (1,726 studies) \n\nMatched 1:5 based on age and sex to \npatients without HCM \n\n6,880 patients, 8,766 ECG studies \n(Cases: 196 patients, 1,461 studies) \n\n196 patients, 1,461 ECG studies \n\nExcluded 265 ineligible \nECG \n(184 with Pacemaker, \n81 with LBBB) \n\n163,259 patients with 539,495 \nECG studies who did not have \nany diagnosis of HCM \n\n159,230 patients, 502,902 ECG \nstudies \n\nExcluded 36,593 \nineligible ECG \n(26,114 with Pacemaker, \n10,468 with LBBB, 1 \nwith non-standard ECG) \n\nPatient level random split \n\nDerivation dataset: \n4,129 patients, 5,148 ECG studies \n(Cases: 119 patients, 770 studies) \n\nValidation dataset: \n1,376 patients, 1,879 ECG studies \n(Cases: 31 patients, 410 studies) \n\nTest dataset: \n1,375 patients, 1,739 ECG studies \n(Cases: 46 patients, 281 studies) \n\nIdentified 226 HCM patients \n\n15 did not have any ECG \navailable in the system \nFigure S6. Data selection procedure for the Keio ECG cohort. \n\nECG: electrocardiogram, Keio: Keio University Hospital, HCM: hypertrophic cardiomyopathy, LBBB: \nleft bundle branch block \n\n142 HCM patients who had ECG \nwere identified (3,707 studies) \n\nMatched 1:5 based on age and sex to \npatients without HCM \n\n13,282 patients, 19,206 ECG studies \n(Cases: 141 patients, 3,201 studies) \n\n141 patients, 3,201 ECG studies \n\nExcluded 506 ineligible \nECG \n(293 with Pacemaker, \n33 with LBBB, 180 with \nnon-standard ECG) \n\n176,356 patients with 739,620 \nECG studies who did not have \nany diagnosis of HCM \n\n175,353 patients, 685,022 ECG \nstudies \n\nExcluded 54,598 \nineligible ECG \n(24,129 with Pacemaker, \n6,455 with LBBB, \n24,014 with non-\nstandard ECG) \n\nPatient level random split \n\nDerivation dataset: \n7,970 patients, 11,625 ECG studies \n(Cases: 95 patients, 2,037 studies) \n\nValidation dataset: \n2,656 patients, 4,022 ECG studies \n(Cases: 27 patients, 821 studies) \n\nTest dataset: \n2,656 patients, 3,559 ECG studies \n(Cases: 19 patients, 343 studies) \n\nIdentified 183 HCM patients \n\n35 did not have any ECG \navailable in the system \n\n2 had pacemaker/ICD \nimplantation before initial \nECG at MGH \n\n4 had myectomy or \nablation before initial \nECG at MGH \nFigure S7. Characteristics of the UMAP space \n\nHCM \n\nHCM \nControl \n\nSampling rate \n\n500 \n250 \n240 \n\nSex \n\nRace \n\nAsian \nWhite \nBlack \nUnknown \n\nHeart rate \n\nHispanic \nOthers \n\nAge \n\nFemale \nMale \n\n\n\nECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, LVH: Left ventricular hypertrophy767 patients, 4274 ECG studies \n(Cases: 447 patients, 3,932 studies) \n\n447 patients, 3,932 ECG \nstudies for Cases \n\n17,671 patients, 19,660 ECG \nstudies for Controls \n\n342 studies for 320 patients did not \nhave LVH \n\n729 studies for 658 patients had \nechocardiogram within 90 days \n\n525 studies for 481 patients had \nmeasurements to determine LVH \nFigure S12. Data selection procedure for BWH ECG cohort evaluating discrimination of HCM \nwith HTN. \n\nHistory of HTN was defined as median systolic blood pressure \u2265140 before the ECG was recorded. \nECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, \nLVH: Left ventricular hypertrophy, LBBB: left bundle branch block. HTN: hypertension. \n\nIdentified 216,477 ECG (50,092 patients) \nwith a history of HTN before the ECG \nrecording for patients without HCM \n\n271 ECG had electronic pacing \n\n8,733 studies for 1,870 patients had \nechocardiogram within 90 days of ECG \n\n6,295 studies for 1,529 patients had \nmeasurements for LV mass calculation \n\n3,071 studies for 648 patients had LVH \n\n2,800 studies for 607 patients \n\n195 ECG had LBBB \n\n2,605 studies for 573 patients \n\n3 ECG had incomplete recording \n\n2,602 studies for 573 patients were \nincluded as HTN with LVH \n3,932 ECG for 447 HCM patients \n\n6,534 studies for 1,020 patients \nFigure S13. Data selection procedure for BWH ECG cohort evaluating discrimination of HCM \nwith AS. \n\nECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, \nLVH: Left ventricular hypertrophy, LBBB: left bundle branch block. AS: aortic valve stenosis. \n\nIdentified 1,269 echocardiograms (939 \npatients) Aortic valve area < 1.0 \n\n327 ECG had electronic pacing \n\n793 patients had ECG within 90 days of \nechocardiogram (7,000 studies) \n\n5,105 studies for 664 patients had \nmeasurements for LV mass calculation \n\n2,753 studies for 340 patients had LVH \n\n2,426studies for 317 patients \n\n356 ECG had LBBB \n\n2,070 studies for 299 patients \n\n3 ECG had incomplete recording \n\n2,067 studies for 299 patients were \nincluded as AS with LVH \n3,932 ECG for 447 HCM patients \n\n5,999 studies for 746 patients \nFigure S14. Data selection procedure for BWH ECG cohort evaluating discrimination of HCM \nwith CA. \n\nECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, \nLVH: Left ventricular hypertrophy, LBBB: left bundle branch block. CA: cardiac amyloidosis. \n\nIdentified 534 patients with cardiac \namyloidosis \n\n1,014 ECG had electronic pacing \n\n6,983 ECG for 433 patient \n\n4,819 ECG for 403 patients were after \ndiagnosis of cardiac amyloidosis \n\n3,805 studies for 376 patients \n\n338 ECG had LBBB \n\n3,467 studies for 370 patients had LVH \n\n234 ECG had incomplete recording \n\n3,233 studies for 364 patients were \nincluded as cardiac amyloidosis \n3,932 ECG for 447 HCM patients \n\n7,165 studies for 811 patients \n\n64 patients had unknown \ndiagnosis date \n\n2,146 ECG were before diagnosis \nof cardiac amyloidosis \nFigure S15. Data selection procedure for BWH ECG cohort with non-apical HCM cases before \ndeveloping LVH. \n\nECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, \nLVH: Left ventricular hypertrophy \n\n17,760 patients, 19,914 ECG studies \n(Cases: 89 patients, 254 studies) \n\n447 patients, 3,932 ECG \nstudies for Cases \n\n17,671 patients, 19,660 ECG \nstudies for Controls \n\n396 studies for 120 patients did not \nhave LVH \n\n1,117 studies for 270 patients had \nmeasurements to determine LVH \n\n1,216 studies for 277 patients had \nechocardiogram within 90 days \n\n254 studies for 89 patients had \nnon-apical HCM \n\n\n\nECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, A4C: apical 4 chamber, FPS: frames per second, PM: pacemaker, ICD: implantable cardioverter defibrillatorFigure S19. Data selection procedure for the UCSF echocardiogram cohort.ECG: electrocardiogram, UCSF: University of California San Francisco, HCM: hypertrophic cardiomyopathy, A4C: apical 4 chamber, FPS: frames per second, PM: pacemaker, ICD: implantable cardioverter defibrillator 177 studies did not have eligible video (\u226530 fps, 1 sec) Matched 1:3 based on age and sex to echocardiogram studies from patients without HCM Excluded ineligible controls 83 with PM/ICD, 149 without A4C, 245 with no eligible videos (\u226530 fps, 1 sec), 123 with missing scale information Identified 21,673 patients with echocardiogram (31,799 studies) 1,031 patients, 1,184 studies (167 patients, 296 studies for HCM) (3,872 videos) Identified 226 HCM patients none had myectomy or ablation before initial echocardiogram at UCSF 17 had pacemaker/ICD implantation before initial echocardiogram at UCSF Figure S20. Data selection procedure for the Keio echocardiogram cohort. ECG: electrocardiogram, Keio: Keio University Hospital, HCM: hypertrophic cardiomyopathy, A4C: apical 4 chamber, FPS: frames per second, PM: pacemaker, ICD: implantable cardioverter defibrillator 166 studies did not have eligible video (\u226530 fps, 1 sec) Matched 1:3 based on age and sex to echocardiogram studies from patients without HCM Excluded ineligible controls 128 with PM/ICD, 107 without A4C, 370 with no eligible videos (\u226530 fps, 1 sec), 2 with missing scale information Identified 33,165 patients with echocardiogram (77,833 studies) 1,639 patients, 2,112 studies (172 patients, 528 studies for HCM) (3,780 videos) Identified 183 HCM patients 6 had myectomy or ablation before initial echocardiogram at UCSF 1 had pacemaker/ICD implantation before initial echocardiogram at UCSF Figure S21. Discrimination of HCM with echocardiogram model in various subgroups ROC plots for HCM discrimination using echocardiogram model trained with a federated manner for various subgroups in the external institution (BWH): limiting the HCM cases to apical HCM or nonapical HCM (Top), limiting HCM cases to those with and without MRI confirmation (Middle), limiting the ECGs to those obtained in outpatient settings and limiting the controls to only those without LVH confirmed with echocardiograms. BWH: Brigham and Women's Hospital. LVH: Left ventricular hypertrophy352 HCM patients with \nechocardiogram before procedure \n(1,025 studies) \n\n337 patients 974 studies \n133 studies did not \ncontain A4C \n337 patients 841 studies \n\n51 studies were after \npacemaker/ICD \nimplantation \n\n327 patients 760 studies \n\n81 studies did not \nhave eligible video \n(\u226530 fps, 1 sec) \n\nMatched 1:3 based on age and sex to \nechocardiogram studies from patients without HCM \n\nExcluded ineligible controls \n420 with PM/ICD, 357 without \nA4C, 288 with no eligible videos \n(\u226530 fps, 1 sec), 6 with missing \nscale information \n\nIdentified 35,951 patients with \nechocardiogram (61,605 studies) \n\n2,455 patients, 3,040 studies \n(327 patients, 760 studies for HCM) \n(8,467 videos) \n\nIdentified 625 HCM patients \n\n45 had myectomy or ablation before initial echocardiogram at BWH \n\n87 had PM/ICD implantation before initial echocardiogram at BWH \n\n352 HCM patients had \nechocardiograms \n(1,268 studies) \n\n116 did not have any echocardiogram available in the system \n\n25 did not have any echocardiogram at age \u2265 20 \n\n243 studies were after \nmyectomy/ablation \nFigure S18. Data selection procedure for the MGH echocardiogram cohort. \n\nECG: electrocardiogram, MGH: Massachusetts General Hospital, HCM: hypertrophic cardiomyopathy, \nA4C: apical 4 chamber, FPS: frames per second, PM: pacemaker, ICD: implantable cardioverter \ndefibrillator \n\n245 HCM patients with \nechocardiogram before procedure \n(565 studies) \n\n243 patients 565 studies \n\n32 studies did not contain A4C \n243 patients 533 studies \n\nno studies were after pacemaker/ICD implantation \n\n242 patients 521 studies \n\n12 studies did not have eligible video (\u226530 fps, 1 sec) \n\nMatched 1:3 based on age and sex to \nechocardiogram studies from patients without HCM \n\nExcluded ineligible controls \n232 with PM/ICD, 150 without \nA4C, 22 with no eligible videos \n(\u226530 fps, 1 sec), 1 with missing \nscale information \n\nIdentified 20,515 patients with \nechocardiogram (33,637 studies) \n\n1,700 patients, 2,056 studies \n(242 patients, 514 studies for HCM) \n(8,405 videos) \n\nIdentified 492 HCM patients \n\n39 had myectomy or ablation before initial echocardiogram at MGH \n\n101 had pacemaker/ICD implantation before initial echocardiogram at MGH \n\n245 HCM patients had echocardiograms \n(571 studies) \n\n104 did not have any echocardiogram available in the system \n\n3 did not have any echocardiogram at age \u2265 20 \n\n6 studies were after myectomy/ablation \n\n242 patients 514 studies \n\n9 studies were missing scale information \n\nPatient level random split \n\nDerivation dataset: \n1,021 patients, 1,224 \nstudies,5,023 videos \n(Cases: 152 patients, 314 studies, \n1,289 videos) \n\nValidation dataset: \n340 patients, 420 studies,1,679 \nvideos \n(Cases: 41 patients, 95 studies, \n399 videos) \n\nTest dataset: \n339 patients, 412 studies,1,685 \nvideos \n(Cases: 49 patients, 105 studies, \n413 videos) \n208 HCM patients with \nechocardiogram before procedure \n(794 studies) \n\n208 patients 727 studies \n\n206 patients 624 studies \n\n190 patients 447 studies \n\n208 HCM patients had echocardiograms \n(870 studies) \n\n1 did not have any echocardiogram available in the system \n\n76 studies were after myectomy/ablation \n\n167 patients 296 studies \n\n151 studies were missing scale information \n\nPatient level random split \n\nDerivation dataset: \n619 patients, 705 studies, 2,321 \nvideos \n(Cases: 107 patients, 180 studies, \n618 videos) \n\nValidation dataset: \n206 patients, 236 studies,733 \nvideos \n(Cases: 27 patients, 51 studies, \n147 videos) \n\nTest dataset: \n206 patients, 243 studies, 818 \nvideos \n(Cases: 33 patients, 65 studies, \n219 videos) \n\n67 studies were after pacemaker/ICD implantation \n\n103 studies did not contain A4C \n728 HCM patients with \nechocardiogram before procedure \n(176 studies) \n\n176 patients 721 studies \n\n175 patients 694 studies \n\n172 patients 528 studies \n\n176 HCM patients had echocardiograms \n(729 studies) \n\nAll remaining patients had echocardiograms in system \n\n1 studies were after myectomy/ablation \n\n172 patients 528 studies \n\n0 studies were missing scale information \n\nPatient level random split \n\nDerivation dataset: \n984 patients, 1,270 studies, 2,251 \nvideos \n(Cases: 102 patients, 318 studies, \n544 videos) \n\nValidation dataset: \n328 patients, 421 studies,755 \nvideos \n(Cases: 36 patients, 107 studies, \n195 videos) \n\nTest dataset: \n327 patients, 421 studies, 774 \nvideos \n(Cases: 34 patients, 103 studies, \n202 videos) \n\n7 studies were after pacemaker/ICD implantation \n\n27 studies did not contain A4C \nMutation (+) \nMutation (-) \n\nAUC = 0.96 \n95% CI = (0.95-0.98) \nN = 2,481 \n\n0.00 \n\n0.25 \n\n0.50 \n\n0.75 \n\n1.00 \n\n0.00 \n0.25 \n0.50 \n0.75 \n1.00 \n\nFalse positive fraction \nTrue positive fraction \n\nBWHGenetic \n\nAUC = 0.96 \n95% CI = (0.95-0.97) \nN = 2,456 \n\n0.00 \n\n0.25 \n\n0.50 \n\n0.75 \n\n1.00 \n\n0.00 \n0.25 \n0.50 \n0.75 \n1.00 \n\nFalse positive fraction \nTrue positive fraction \n\nBWHNOGenetic \n\nMRI-Confirmed \nNo MRI \n\nNo-LVH Controls \nOutpatient Studies \n\nAUC = 0.96 \n95% CI = (0.95-0.97) \nN = 2,810 \n\n0.00 \n\n0.25 \n\n0.50 \n\n0.75 \n\n1.00 \n\n0.00 \n0.25 \n0.50 \n0.75 \n1.00 \n\nFalse positive fraction \nTrue positive fraction \n\nBWHMRI \n\nAUC = 0.97 \n95% CI = (0.96-0.98) \nN = 2,510 \n\n0.00 \n\n0.25 \n\n0.50 \n\n0.75 \n\n1.00 \n\n0.00 \n0.25 \n0.50 \n0.75 \n1.00 \n\nFalse positive fraction \nTrue positive fraction \n\n\n\n\nIdentified 5,335 echocardiograms (4,202 patients) with a history of HTN before the study for patients without HCM 15 had pacemaker/ICD implantation before study 2,818 studies for 2,412 patients had measurements for LV mass calculation 940 studies for 925 patients had LVH 833 studies for 731 patients 49 did not have A4C videos 42 studies did not have eligible video (\u226530 fps, 1 sec) Cases: 327 patients, 760 studies) Figure S25. Data selection procedure for BWH echocardiogram cohort with non-apical HCM cases before developing LVH. ECG: electrocardiogram, BWH: Brigham and Women's Hospital, HCM: hypertrophic cardiomyopathy, LVH: Left ventricular hypertrophy 327 HCM patients with 760 studies patients, 2,403 studies (Cases: 94 patients, 123 studies) 162 studies for 122 HCM patients did not have LVH 123 studies for 94 HCM patients was not Apical HCM 2,280 studies for 2,128 control patients Figure S26. Data selection procedure for the ECG-echocardiogram surveillance cohort. ECG: electrocardiogram, HCM: hypertrophic cardiomyopathy, A4C: apical 4 chamber, FPS: frames per second. Selected pairs of ECG and echocardiogram with closest recoding dates for each patient 11,764 patients underwent ECG and echocardiography study within 30 days in control groupFigure S27. Decision curve for ECG model deployment simulation.1 study was missing scale \ninformation \n\n327 HCM patients with \n760 studies \n\n1,491 patients, 1,593 studies \n(Identified 327 HCM patients with 760 \neligible echocardiography studies \n\nWithin those with eligible \nechocardiogram 326 patients had at \nleast 1 ECG (5,041 studies total) \n\n204 ECG had \nelectronic pacing \n\n141 ECG had LBBB \n\nCases \n\n1,392 ECG had \nincomplete recording \n\n314 patients, 3,304 ECG were \ncandidates for matching \n\n273 HCM patients underwent ECG and \nechocardiography study within 30 days \n\nSelected pairs of ECG and \nechocardiogram with closest recoding \ndates for each patient \n\nControls \n\nIdentified 2,682,998 ECG \nstudies from 471,012 patients \nwithout HCM diagnosis \n\nWithin those with eligible ECG 21,069 \npatients had at least 1 echocardiogram \n(36,050 studies total) \n\nRandomly selected 59 patients to \nachieve a prevalence of 0.5 % \n\n5,700 studies were \nafter pacemaker/ICD \nimplantation \n\n3,414 studies did not \nhave A4C view \n\n2,664 studies did not \nhave eligible video \n(\u226530 fps, 1 sec) \n\n53 studies was \nmissing scale \ninformation \n\n16,584 patients, 24,219 studies were \ncandidates for matching \n\nECG \n\nEchocardiogram \n\n0.000 \n\n0.001 \n\n0.002 \n\n0.003 \n\n0.004 \n\n0.005 \n\n0% \n5% \n10% \n15% \n20% \n25% \n\nThreshold Probability \n\nNet Benefit \n\nTreat All \n\nTreat None \n\nRY any abnormal ECG \n\nRY voltage criteria for LVH \n\nRY suspect HCM \n\nSG any abnormal ECG \n\nSG voltage criteria for LVH \n\nSG suspect HCM \n\nJJ any abnormal ECG \n\nJJ voltage criteria for LVH \n\nJJ suspect HCM \n\nECG HCM model \n\n5% \n10% \n15% \n20% \n25% \n\nThreshold Probability \n\nTreat All \n\nTreat None \n\nRY any abnormal ECG \n\nRY voltage criteria for LVH \n\nRY suspect HCM \n\nSG any abnormal ECG \n\nSG voltage criteria for LVH \n\nSG suspect HCM \n\nJJ any abnormal ECG \n\nJJ voltage criteria for LVH \n\nJJ suspect HCM \n\nECG HCM model \n\n0.000 \n\n0.001 \n\n0.002 \n\n0.003 \n\n0.004 \n\n0.005 \n\n0% \n5% \n10% \n15% \n20% \n25% \n\nThreshold Probability \n\nNet Benefit \n\nTreat All \n\nTreat None \n\nRY suspect HCM \n\nSG suspect HCM \n\nJJ suspect HCM \n\nechocardiogram HCM model \n\n5% \n10% \n15% \n20% \n25% \n\nThreshold Probability \n\nTreat All \n\nTreat None \n\nRY suspect HCM \n\nSG suspect HCM \n\nJJ suspect HCM \n\nechocardiogram HCM model \n\nhad pacemaker/ICD implantation before initial ECG at MGH\npatients, 1,106 studies (Cases: 327 patients, 760 studies)\nFigure S23. Data selection procedure for BWH echocardiogram cohort evaluating discrimination of HCM with AS.", "annotations": {"author": null, "publisher": null, "author_last_name": null, "author_first_name": null, "author_affiliation": null, "title": null, "venue": null, "abstract": "[{\"end\":929,\"start\":4}]", "bib_ref": null, "figure": "[{\"attributes\":{\"id\":\"fig_0\"},\"end\":12962,\"start\":12532},{\"attributes\":{\"id\":\"fig_1\"},\"end\":13224,\"start\":12963},{\"attributes\":{\"id\":\"fig_2\"},\"end\":13593,\"start\":13225},{\"attributes\":{\"id\":\"fig_3\"},\"end\":13960,\"start\":13594},{\"attributes\":{\"id\":\"fig_4\"},\"end\":15232,\"start\":13961},{\"attributes\":{\"id\":\"fig_5\"},\"end\":15255,\"start\":15233},{\"attributes\":{\"id\":\"fig_6\"},\"end\":15900,\"start\":15256},{\"attributes\":{\"id\":\"fig_7\"},\"end\":16660,\"start\":15901},{\"attributes\":{\"id\":\"fig_8\"},\"end\":17035,\"start\":16661},{\"attributes\":{\"id\":\"fig_9\"},\"end\":17569,\"start\":17036},{\"attributes\":{\"id\":\"tab_0\",\"type\":\"table\"},\"end\":20659,\"start\":17570},{\"attributes\":{\"id\":\"tab_1\",\"type\":\"table\"},\"end\":22881,\"start\":20660},{\"attributes\":{\"id\":\"tab_2\",\"type\":\"table\"},\"end\":24077,\"start\":22882},{\"attributes\":{\"id\":\"tab_3\",\"type\":\"table\"},\"end\":25185,\"start\":24078},{\"attributes\":{\"id\":\"tab_4\",\"type\":\"table\"},\"end\":30087,\"start\":25186},{\"attributes\":{\"id\":\"tab_5\",\"type\":\"table\"},\"end\":30831,\"start\":30088},{\"attributes\":{\"id\":\"tab_6\",\"type\":\"table\"},\"end\":33032,\"start\":30832},{\"attributes\":{\"id\":\"tab_7\",\"type\":\"table\"},\"end\":34231,\"start\":33033},{\"attributes\":{\"id\":\"tab_8\",\"type\":\"table\"},\"end\":34971,\"start\":34232},{\"attributes\":{\"id\":\"tab_9\",\"type\":\"table\"},\"end\":36391,\"start\":34972},{\"attributes\":{\"id\":\"tab_10\",\"type\":\"table\"},\"end\":38114,\"start\":36392},{\"attributes\":{\"id\":\"tab_11\",\"type\":\"table\"},\"end\":38402,\"start\":38115},{\"attributes\":{\"id\":\"tab_12\",\"type\":\"table\"},\"end\":38782,\"start\":38403},{\"attributes\":{\"id\":\"tab_13\",\"type\":\"table\"},\"end\":44382,\"start\":38783},{\"attributes\":{\"id\":\"tab_14\",\"type\":\"table\"},\"end\":48144,\"start\":44383},{\"attributes\":{\"id\":\"tab_15\",\"type\":\"table\"},\"end\":55897,\"start\":48145},{\"attributes\":{\"id\":\"tab_16\",\"type\":\"table\"},\"end\":59407,\"start\":55898}]", "paragraph": "[{\"end\":1610,\"start\":996},{\"end\":2331,\"start\":1665},{\"end\":2758,\"start\":2353},{\"end\":3534,\"start\":2802},{\"end\":3779,\"start\":3581},{\"end\":4085,\"start\":3781},{\"end\":4193,\"start\":4087},{\"end\":4327,\"start\":4195},{\"end\":5263,\"start\":4329},{\"end\":5408,\"start\":5265},{\"end\":6290,\"start\":5410},{\"end\":7186,\"start\":6348},{\"end\":8072,\"start\":7255},{\"end\":8916,\"start\":8119},{\"end\":9264,\"start\":8974},{\"end\":9565,\"start\":9364},{\"end\":9746,\"start\":9567},{\"end\":11379,\"start\":9813},{\"end\":11468,\"start\":11385},{\"end\":12034,\"start\":11793},{\"end\":12531,\"start\":12036}]", "formula": "[{\"attributes\":{\"id\":\"formula_0\"},\"end\":11792,\"start\":11469}]", "table_ref": null, "section_header": "[{\"end\":952,\"start\":931},{\"end\":975,\"start\":955},{\"end\":994,\"start\":978},{\"end\":1663,\"start\":1613},{\"end\":2351,\"start\":2334},{\"end\":2800,\"start\":2761},{\"end\":3579,\"start\":3537},{\"end\":6346,\"start\":6293},{\"end\":7253,\"start\":7189},{\"end\":8117,\"start\":8075},{\"end\":8972,\"start\":8919},{\"end\":9287,\"start\":9267},{\"end\":9362,\"start\":9290},{\"end\":9811,\"start\":9749},{\"end\":11383,\"start\":11382},{\"end\":13984,\"start\":13962},{\"end\":15243,\"start\":15234},{\"end\":15281,\"start\":15257},{\"end\":15926,\"start\":15902},{\"end\":16674,\"start\":16662},{\"end\":17073,\"start\":17037},{\"end\":17581,\"start\":17571},{\"end\":20671,\"start\":20661},{\"end\":22893,\"start\":22883},{\"end\":24089,\"start\":24079},{\"end\":25197,\"start\":25187},{\"end\":30843,\"start\":30833},{\"end\":33044,\"start\":33034},{\"end\":34244,\"start\":34233},{\"end\":34984,\"start\":34973},{\"end\":36404,\"start\":36393},{\"end\":38127,\"start\":38116}]", "table": "[{\"end\":20659,\"start\":17642},{\"end\":22881,\"start\":20734},{\"end\":24077,\"start\":22948},{\"end\":25185,\"start\":24143},{\"end\":30087,\"start\":25765},{\"end\":30831,\"start\":30803},{\"end\":33032,\"start\":30917},{\"end\":34231,\"start\":33239},{\"end\":34971,\"start\":34310},{\"end\":36391,\"start\":35505},{\"end\":38114,\"start\":36464},{\"end\":38402,\"start\":38198},{\"end\":38782,\"start\":38596},{\"end\":44382,\"start\":39196},{\"end\":48144,\"start\":44511},{\"end\":55897,\"start\":50661},{\"end\":59407,\"start\":57222}]", "figure_caption": "[{\"end\":12962,\"start\":12534},{\"end\":13224,\"start\":12965},{\"end\":13593,\"start\":13227},{\"end\":13960,\"start\":13596},{\"end\":15232,\"start\":13989},{\"end\":15255,\"start\":15246},{\"end\":15900,\"start\":15288},{\"end\":16660,\"start\":15933},{\"end\":17035,\"start\":16678},{\"end\":17569,\"start\":17083},{\"end\":17642,\"start\":17584},{\"end\":20734,\"start\":20674},{\"end\":22948,\"start\":22896},{\"end\":24143,\"start\":24092},{\"end\":25765,\"start\":25200},{\"end\":30803,\"start\":30090},{\"end\":30917,\"start\":30846},{\"end\":33239,\"start\":33047},{\"end\":34310,\"start\":34248},{\"end\":35505,\"start\":34988},{\"end\":36464,\"start\":36408},{\"end\":38198,\"start\":38131},{\"end\":38596,\"start\":38405},{\"end\":39196,\"start\":38785},{\"end\":44511,\"start\":44385},{\"end\":50661,\"start\":48147},{\"end\":57222,\"start\":55900}]", "figure_ref": "[{\"attributes\":{\"ref_id\":\"fig_5\"},\"end\":2329,\"start\":2319},{\"attributes\":{\"ref_id\":\"fig_5\"},\"end\":7118,\"start\":7108},{\"end\":8005,\"start\":7995},{\"end\":9744,\"start\":9735},{\"end\":11427,\"start\":11418},{\"attributes\":{\"ref_id\":\"fig_5\"},\"end\":11977,\"start\":11968}]", "bib_author_first_name": null, "bib_author_last_name": null, "bib_entry": null, "bib_title": null, "bib_author": null, "bib_venue": null}}}, "year": 2023, "month": 12, "day": 17}