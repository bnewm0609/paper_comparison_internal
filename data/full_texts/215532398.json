{"id": 215532398, "updated": "2023-11-10 23:08:50.314", "metadata": {"title": "Automatic diagnosis of the 12-lead ECG using a deep neural network", "authors": "[{\"first\":\"Ant\u00f4nio\",\"last\":\"Ribeiro\",\"middle\":[\"H.\"]},{\"first\":\"Manoel\",\"last\":\"Ribeiro\",\"middle\":[\"Horta\"]},{\"first\":\"Gabriela\",\"last\":\"Paix\u00e3o\",\"middle\":[\"M.\",\"M.\"]},{\"first\":\"Derick\",\"last\":\"Oliveira\",\"middle\":[\"M.\"]},{\"first\":\"Paulo\",\"last\":\"Gomes\",\"middle\":[\"R.\"]},{\"first\":\"J\u00e9ssica\",\"last\":\"Canazart\",\"middle\":[\"A.\"]},{\"first\":\"Milton\",\"last\":\"Ferreira\",\"middle\":[\"P.\",\"S.\"]},{\"first\":\"Carl\",\"last\":\"Andersson\",\"middle\":[\"R.\"]},{\"first\":\"Peter\",\"last\":\"Macfarlane\",\"middle\":[\"W.\"]},{\"first\":\"Meira\",\"last\":\"Wagner Jr.\",\"middle\":[]},{\"first\":\"Thomas\",\"last\":\"Sch\u00f6n\",\"middle\":[\"B.\"]},{\"first\":\"Antonio\",\"last\":\"Ribeiro\",\"middle\":[\"Luiz\",\"P.\"]}]", "venue": "Nature Communications", "journal": "Nature Communications", "publication_date": {"year": 2020, "month": 4, "day": 9}, "abstract": "The role of automatic electrocardiogram (ECG) analysis in clinical practice is limited by the accuracy of existing models. Deep Neural Networks (DNNs) are models composed of stacked transformations that learn tasks by examples. This technology has recently achieved striking success in a variety of task and there are great expectations on how it might improve clinical practice. Here we present a DNN model trained in a dataset with more than 2 million labeled exams analyzed by the Telehealth Network of Minas Gerais and collected under the scope of the CODE (Clinical Outcomes in Digital Electrocardiology) study. The DNN outperform cardiology resident medical doctors in recognizing 6 types of abnormalities in 12-lead ECG recordings, with F1 scores above 80% and specificity over 99%. These results indicate ECG analysis based on DNNs, previously studied in a single-lead setup, generalizes well to 12-lead exams, taking the technology closer to the standard clinical practice.", "fields_of_study": "[\"Medicine\"]", "external_ids": {"arxiv": null, "mag": "3099085560", "acl": null, "pubmed": "32273514", "pubmedcentral": "7145824", "dblp": null, "doi": "10.1038/s41467-020-15432-4"}}, "content": {"source": {"pdf_hash": "212108d5b29cf431a8f04bf511645ee5ef2c5d1e", "pdf_src": "PubMedCentral", "pdf_uri": null, "oa_url_match": false, "oa_info": {"license": "CCBY", "open_access_url": "https://www.nature.com/articles/s41467-020-15432-4.pdf", "status": "GOLD"}}, "grobid": {"id": "0f8b792253e123e326c6c330a49f5687695f6b37", "type": "plain-text", "url": "s3://ai2-s2-pdf-extraction-prod/parse-results/s2orc_worker/212108d5b29cf431a8f04bf511645ee5ef2c5d1e.txt", "contents": "\nSupplementary Information: Automatic diagnosis of the 12-lead ECG using a deep neural network\n\n\nAnt\u00f4nio H Ribeiro 1antonio-ribeiro@ufmg.br \nUniversidade Federal de Minas Gerais\nBrazil\n\nUppsala University\nSweden\n\nManoel Horta Ribeiro \nGabriela M M Paix\u00e3o \nUniversidade Federal de Minas Gerais\nBrazil\n\nTelehealth Center from Hospital das Cl\u00ednicas da Universidade Federal de Minas Gerais\nBrazil\n\nDerick M Oliveira \nUniversidade Federal de Minas Gerais\nBrazil\n\nPaulo R Gomes \nUniversidade Federal de Minas Gerais\nBrazil\n\nTelehealth Center from Hospital das Cl\u00ednicas da Universidade Federal de Minas Gerais\nBrazil\n\nJ\u00e9ssica A Canazart \nUniversidade Federal de Minas Gerais\nBrazil\n\nTelehealth Center from Hospital das Cl\u00ednicas da Universidade Federal de Minas Gerais\nBrazil\n\nMilton P S Ferreira \nUniversidade Federal de Minas Gerais\nBrazil\n\nTelehealth Center from Hospital das Cl\u00ednicas da Universidade Federal de Minas Gerais\nBrazil\n\nCarl R Andersson \nUppsala University\nSweden\n\nPeter W Macfarlane \nGlasgow University\nScotland\n\nWagner Meira Jr\nUniversidade Federal de Minas Gerais\nBrazil\n\nThomas B Sch\u00f6n \nUppsala University\nSweden\n\nAntonio Luiz \nP Ribeiro \nUniversidade Federal de Minas Gerais\nBrazil\n\nTelehealth Center from Hospital das Cl\u00ednicas da Universidade Federal de Minas Gerais\nBrazil\n\nSupplementary Information: Automatic diagnosis of the 12-lead ECG using a deep neural network\n\n\n\nreplacement (i.e. bootstrapping) from the test set was used to generate n = 1000 samples. The results are given for the DNN, the medical residents and students. Source data are provided as a Source Data file. The boxplots should be read as follows: the central line correspond to the median value of the empirical distribution, the box region correspond to the range of values between the first and third quartile (also knonw as interquartile range or IQR), the whiskers extend from 1.5 IQR below and above the firsth and third quartiles, values outside of that range are considered outliers and show as diamonds. \n\n\nSupplementary Figure 2. (Bootstrapped scores for alternative splits)\n\nBoxplots for the bootstrapped F1 scores for the DNN using alternative 90%-5%-5% splits for training, validation and as a secondary test set. For the splits ordered: randomly; by date; and, stratified by patients. In all cases, the performance is evaluated on: (a) the original test set for n = 1000 bootstraped samples; and, on (b) the secondary test set (last 5% split) for n = 200 bootstraped samples. On (a), we also present the original DNN performance for comparison, which was developed using a 98%-2% split. The performance gap between (a) and (b) is due to the difference in the gold standard. The secondary test set obtained from the last 5% has a less accurate annotation, since it has not been annotated by multiple doctors and it uses natural language processing to extract the diagnosis from a written report. This extra noise result in worse F1 score in (b) when compared with (a). On the other hand, the secondary 5% test split contain more than 100,000 records, which yield more stable performance in the bootstrap analysis, with more concentrated empirical distributions for the F1 score. Both RBBB and LBBB (highlighted on the plot) present on (b) a statistically significant difference between the performance of the split ordered by date and the other two splits, that difference is due to some changes in personal that took place in the the Telehealth center, that affected the period used in the test set (10-2016 to 06-2017), resulting in lower annotation quality. A certified cardiologist reviewed cases for which the neural network have been considered wrong when compared to the gold standard from the 5% split collected from 10-2016 to 06-2017, 100 supposedly wrong RBBB and 100 supposedly wrong LBBB. The certified cardiologist reported that the neural network is actually correct, respectively, 86% and 83% percent of the cases. This analysis show the importance of a test set with a good annotation quality to obtain reliable estimation of the DNN performance. And, also, that  , which delimit the consensus definition of SB and ST. Notice that most exams for which the neural network fails to get the correct result are very close to this threshold line and are the borderline cases we mentioned in the discussion. It should be highlighted that this automatic measurement system is not perfect, and measurements that may indicate some of the conditions do not necessarily agree with our board of cardiologist (e.g. there are exams with heart rate above 100 acording to Uni-G that are not classified by our cardiologist as ST).\n\nFigure 1 .\n1(Bootstrapped scores) Display boxplots of empirical distribution of precision, recall, specificity and F1 score on the test set. Sampling with\n\n\nperiods of lower annotation quality in the dataset are overcome by a very high number of examples. Source data are provided as a Source Data file. See Supplementary Figure 1 caption for the definition of all elements in the boxplot.\n\nFigure 3 .\n3(Heart rate vs DNN predictions) Heart rate measured by the Uni-G software for samples in the test set is given on the y-axis. The color indicates if the DNN make the correct prediction or not. The x-axis separates the dataset accordingly to the presence of: SB in (a); and, ST in (b). A horizontal line show the threshold of 50 bpm for SB in (a); and, of 100 bpm for ST in (b)\n\n\nShow the Kappa scores measuring the inter-rater agreement on the test set. In (a), we compare the DNN, the medical residents and the students two at a time. In (b), we compare the DNN, and the certified cardiologists that annotated the test set (certif. cardiol.). If the raters are in complete agreement then it is equal to 1. If there is no agreement among the raters other than what would be expected by chance it is equal to 0.predicted label \nDNN \ncardio. \nemerg. \nstud. \ntrue label \nnot present \npresent \nnot present \npresent \nnot present \npresent \nnot present \npresent \n\n1dAVb \nnot present \n\n795 \n4 \n797 \n2 \n786 \n13 \n782 \n17 \n\npresent \n\n2 \n26 \n9 \n19 \n5 \n23 \n2 \n26 \n\nRBBB \nnot present \n\n789 \n4 \n788 \n5 \n792 \n1 \n790 \n3 \n\npresent \n\n0 \n34 \n1 \n33 \n8 \n26 \n2 \n32 \n\nLBBB \nnot present \n\n797 \n0 \n797 \n0 \n796 \n1 \n795 \n2 \n\npresent \n\n0 \n30 \n3 \n27 \n4 \n26 \n3 \n27 \n\nSB \nnot present \n\n808 \n3 \n808 \n3 \n808 \n3 \n807 \n4 \n\npresent \n\n1 \n15 \n1 \n15 \n2 \n14 \n4 \n12 \n\nAF \nnot present \n\n814 \n0 \n811 \n3 \n812 \n2 \n805 \n9 \n\npresent \n\n3 \n10 \n3 \n10 \n5 \n8 \n1 \n12 \n\nST \nnot present \n\n788 \n2 \n789 \n1 \n788 \n2 \n787 \n3 \n\npresent \n\n1 \n36 \n7 \n30 \n2 \n35 \n6 \n31 \n\nSupplementary Table 1. (Confusion matrices) Show the absolute number of: i) false posives; ii) false negatives; iii) true positives; and, iv) true negatives, for each abnormality \non the test set. \n\n1dAVb \nRBBB \nLBBB \nSB \nAF \nST \n\nDNN vs cardio. \n\n0.656 \n0.917 \n0.945 \n0.830 \n0.780 \n0.864 \n\nDNN vs emerg. \n\n0.684 \n0.792 \n0.909 \n0.796 \n0.595 \n0.930 \n\nDNN vs stud. \n\n0.642 \n0.928 \n0.912 \n0.760 \n0.574 \n0.855 \n\ncardio. vs emerg. \n\n0.656 \n0.824 \n0.923 \n0.912 \n0.515 \n0.847 \n\ncardio. vs stud. \n\n0.612 \n0.871 \n0.889 \n0.880 \n0.700 \n0.792 \n\nemerg. vs stud. \n\n0.615 \n0.799 \n0.852 \n0.907 \n0.508 \n0.897 \n\n(a) \n\n1dAVb \nRBBB \nLBBB \nSB \nAF \nST \n\nDNN vs Cert. cardiol. 1 \n\n0.758 \n0.928 \n0.964 \n0.770 \n0.696 \n0.847 \n\nDNN vs Certif. cardiol. 2 \n\n0.852 \n0.942 \n1.000 \n0.770 \n0.746 \n0.884 \n\nCert. cardiol. 1 vs Certif. cardiol. 2 \n\n0.741 \n0.955 \n0.964 \n0.844 \n0.831 \n0.902 \n\n(b) \n\nSupplementary Table 2. (Kappa coefficients) \n\n\nSupplementaryTable 3. (McNemar test) Display the p-values for the McNemar test comparing the misclassification on the test set. The DNN, the medical residents and the students were compared two at a time. Entries with statistical significance (with 0.05 significance level) are displayed in boldface.1dAVb \nRBBB \nLBBB \nSB \nAF \nST \n\nDNN vs cardio. \n\n0.225 \n0.414 \n0.083 \n1.000 \n0.180 \n0.096 \n\nDNN vs emerg. \n0.007 \n\n0.166 \n0.025 \n0.705 \n0.157 \n0.655 \n\nDNN vs stud. \n0.009 \n\n0.655 \n0.025 \n0.157 \n0.052 \n0.058 \n\ncardio. vs emerg. \n\n0.108 \n0.366 \n0.317 \n0.564 \n0.763 \n0.206 \n\ncardio. vs stud. \n\n0.102 \n0.739 \n0.414 \n\n0.046 \n\n0.206 \n0.782 \n\nemerg. vs stud. \n\n0.853 \n0.248 \n1.000 \n0.083 \n0.439 \n0.059 \n\n1dAVb SB \n\nAF \nST RBBB LBBB \n0.4 \n\n0.5 \n\n0.6 \n\n0.7 \n\n0.8 \n\n0.9 \n\n1.0 \n\nF1 score \n\nrandom \nby date \nby patient \noriginal DNN \n\n(a) original test set \n\n1dAVb SB \nAF \nST RBBB LBBB \n0.4 \n\n0.5 \n\n0.6 \n\n0.7 \n\n0.8 \n\n0.9 \n\n1.0 \n\nF1 score \n\nrandom \nby date \nby patient \n\n(b) secondary test set (last 5% split) \n\n\n", "annotations": {"author": "[{\"end\":212,\"start\":97},{\"end\":234,\"start\":213},{\"end\":393,\"start\":235},{\"end\":457,\"start\":394},{\"end\":610,\"start\":458},{\"end\":768,\"start\":611},{\"end\":927,\"start\":769},{\"end\":972,\"start\":928},{\"end\":1021,\"start\":973},{\"end\":1082,\"start\":1022},{\"end\":1125,\"start\":1083},{\"end\":1139,\"start\":1126},{\"end\":1288,\"start\":1140}]", "publisher": null, "author_last_name": "[{\"end\":114,\"start\":107},{\"end\":233,\"start\":226},{\"end\":254,\"start\":248},{\"end\":411,\"start\":403},{\"end\":471,\"start\":466},{\"end\":629,\"start\":621},{\"end\":788,\"start\":780},{\"end\":944,\"start\":935},{\"end\":991,\"start\":981},{\"end\":1034,\"start\":1029},{\"end\":1097,\"start\":1092},{\"end\":1138,\"start\":1134},{\"end\":1149,\"start\":1142}]", "author_first_name": "[{\"end\":104,\"start\":97},{\"end\":106,\"start\":105},{\"end\":219,\"start\":213},{\"end\":225,\"start\":220},{\"end\":243,\"start\":235},{\"end\":247,\"start\":244},{\"end\":400,\"start\":394},{\"end\":402,\"start\":401},{\"end\":463,\"start\":458},{\"end\":465,\"start\":464},{\"end\":618,\"start\":611},{\"end\":620,\"start\":619},{\"end\":775,\"start\":769},{\"end\":779,\"start\":776},{\"end\":932,\"start\":928},{\"end\":934,\"start\":933},{\"end\":978,\"start\":973},{\"end\":980,\"start\":979},{\"end\":1028,\"start\":1022},{\"end\":1089,\"start\":1083},{\"end\":1091,\"start\":1090},{\"end\":1133,\"start\":1126},{\"end\":1141,\"start\":1140}]", "author_affiliation": "[{\"end\":184,\"start\":141},{\"end\":211,\"start\":186},{\"end\":299,\"start\":256},{\"end\":392,\"start\":301},{\"end\":456,\"start\":413},{\"end\":516,\"start\":473},{\"end\":609,\"start\":518},{\"end\":674,\"start\":631},{\"end\":767,\"start\":676},{\"end\":833,\"start\":790},{\"end\":926,\"start\":835},{\"end\":971,\"start\":946},{\"end\":1020,\"start\":993},{\"end\":1081,\"start\":1038},{\"end\":1124,\"start\":1099},{\"end\":1194,\"start\":1151},{\"end\":1287,\"start\":1196}]", "title": "[{\"end\":94,\"start\":1},{\"end\":1382,\"start\":1289}]", "venue": null, "abstract": null, "bib_ref": null, "figure": "[{\"attributes\":{\"id\":\"fig_0\"},\"end\":4786,\"start\":4631},{\"attributes\":{\"id\":\"fig_1\"},\"end\":5021,\"start\":4787},{\"attributes\":{\"id\":\"fig_2\"},\"end\":5411,\"start\":5022},{\"attributes\":{\"id\":\"tab_0\",\"type\":\"table\"},\"end\":7446,\"start\":5412},{\"attributes\":{\"id\":\"tab_1\",\"type\":\"table\"},\"end\":8448,\"start\":7447}]", "paragraph": "[{\"end\":2000,\"start\":1386},{\"end\":4630,\"start\":2073}]", "formula": null, "table_ref": null, "section_header": "[{\"end\":2071,\"start\":2003},{\"end\":4642,\"start\":4632},{\"end\":5033,\"start\":5023}]", "table": "[{\"end\":7446,\"start\":5845},{\"end\":8448,\"start\":7749}]", "figure_caption": "[{\"end\":4786,\"start\":4644},{\"end\":5021,\"start\":4789},{\"end\":5411,\"start\":5035},{\"end\":5845,\"start\":5414},{\"end\":7749,\"start\":7449}]", "figure_ref": null, "bib_author_first_name": null, "bib_author_last_name": null, "bib_entry": null, "bib_title": null, "bib_author": null, "bib_venue": null}}}, "year": 2023, "month": 12, "day": 17}